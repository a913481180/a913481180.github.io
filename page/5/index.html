<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/1.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/1.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.baidu.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":false,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="KK">
<meta property="og:url" content="http://www.baidu.com/page/5/index.html">
<meta property="og:site_name" content="KK">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="KK">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://www.baidu.com/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>KK</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">KK</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2020/01/22/23-33-33/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/22/23-33-33/" class="post-title-link" itemprop="url">uni-App</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-01-22 23:33:33" itemprop="dateCreated datePublished" datetime="2020-01-22T23:33:33+08:00">2020-01-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="uniApp"><a href="#uniApp" class="headerlink" title="uniApp"></a>uniApp</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul>
<li>配置浏览器目录</li>
<li>微信小程序-》设置-》安全设置-》打开多端口服务</li>
</ul>
<h2 id="尺寸单位"><a href="#尺寸单位" class="headerlink" title="尺寸单位"></a>尺寸单位</h2><ul>
<li><p>支持的通用 css 单位包括 px、rpx</p>
</li>
<li><p>px 即屏幕像素<br>rpx 即响应式 px，一种根据屏幕宽度自适应的动态单位。以 750 宽的屏幕为基准，750rpx 恰好为屏幕宽度。屏幕变宽，rpx 实际显示效果会等比放大，但在 App（vue2 不含 nvue） 端和 H5（vue2） 端屏幕宽度达到 960px 时，默认将按照 375px 的屏幕宽度进行计算，具体配置参考</p>
</li>
</ul>
<p>vue 页面支持下面这些普通 H5 单位，但在 nvue 里不支持：</p>
<p>rem 根字体大小可以通过 page-meta 配置<br>vh viewpoint height，视窗高度，1vh 等于视窗高度的 1%<br>vw viewpoint width，视窗宽度，1vw 等于视窗宽度的 1%<br>nvue 还不支持百分比单位。</p>
<p>App 端，在 pages.json 里的 titleNView 或页面里写的 plus api 中涉及的单位，只支持 px。注意此时不支持 rpx<br>nvue 中，uni-app 模式（nvue 不同编译模式介绍）可以使用 px 、rpx，表现与 vue 中基本一致，另外启用 dynamicRpx 后可以适配屏幕大小动态变化。weex 模式目前遵循 weex 的单位，它的单位比较特殊：</p>
<p>px:，以 750 宽的屏幕为基准动态计算的长度单位，与 vue 页面中的 rpx 理念相同。（一定要注意 weex 模式的 px，和 vue 里的 px 逻辑不一样。）<br>wx：与设备屏幕宽度无关的长度单位，与 vue 页面中的 px 理念相同<br>下面对 rpx 详细说明：</p>
<p>设计师在提供设计图时，一般只提供一个分辨率的图。</p>
<p>严格按设计图标注的 px 做开发，在不同宽度的手机上界面很容易变形。</p>
<p>而且主要是宽度变形。高度一般因为有滚动条，不容易出问题。由此，引发了较强的动态宽度单位需求。<br>rpx 是相对于基准宽度的单位，可以根据屏幕宽度进行自适应。uni-app 规定屏幕基准宽度 750rpx。</p>
<p>开发者可以通过设计稿基准宽度计算页面元素 rpx 值，设计稿 1px 与框架样式 1rpx 转换公式如下：</p>
<p>设计稿 1px / 设计稿基准宽度 = 框架样式 1rpx / 750rpx</p>
<p>换言之，页面元素宽度在 uni-app 中的宽度计算公式：</p>
<p>750 * 元素在设计稿中的宽度 / 设计稿基准宽度</p>
<p>举例说明：</p>
<p>若设计稿宽度为 750px，元素 A 在设计稿上的宽度为 100px，那么元素 A 在 uni-app 里面的宽度应该设为：750 _ 100 / 750，结果为：100rpx。<br>若设计稿宽度为 640px，元素 A 在设计稿上的宽度为 100px，那么元素 A 在 uni-app 里面的宽度应该设为：750 _ 100 / 640，结果为：117rpx。<br>若设计稿宽度为 375px，元素 B 在设计稿上的宽度为 200px，那么元素 B 在 uni-app 里面的宽度应该设为：750 * 200 / 375，结果为：400rpx。<br>Tips</p>
<p>注意 rpx 是和宽度相关的单位，屏幕越宽，该值实际像素越大。如不想根据屏幕宽度缩放，则应该使用 px 单位。<br>如果开发者在字体或高度中也使用了 rpx ，那么需注意这样的写法意味着随着屏幕变宽，字体会变大、高度会变大。如果你需要固定高度，则应该使用 px 。<br>rpx 不支持动态横竖屏切换计算，使用 rpx 建议锁定屏幕方向<br>设计师可以用 iPhone6 作为视觉稿的标准。<br>如果设计稿不是 750px，HBuilderX 提供了自动换算的工具，详见：HBuilderX 中自动转换 px 为 upx。<br>App 端，在 pages.json 里的 titleNView 或页面里写的 plus api 中涉及的单位，只支持 px，不支持 rpx。<br>早期 uni-app 提供了 upx ，目前已经推荐统一改为 rpx 了.</p>
<h2 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h2><p>目前支持的选择器有：<code>.class</code> <code>#id</code> <code>element</code> (<code>::after</code> <code>::before</code> )仅 vue 页面生效<br>注意：</p>
<p>在 uni-app 中不能使用 * 选择器。</p>
<p>微信小程序自定义组件中仅支持 class 选择器</p>
<p>page 相当于 body 节点，例如：</p>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>uni-app 页面路由为框架统一管理，开发者需要在 pages.json 里配置每个路由页面的路径及页面样式。类似小程序在 app.json 中配置页面路由一样。所以 uni-app 的路由用法与 Vue Router 不同，如仍希望采用 Vue Router 方式管理路由，可在插件市场搜索 Vue-Router。</p>
<p>#路由跳转<br>uni-app 有两种页面路由跳转方式：使用 navigator 组件跳转、调用 API 跳转</p>
<p>|路由方式| 页面栈表现| 触发时机|<br>|初始化 |新页面入栈 uni-app 打开的第一个页面|<br>|打开新页面 |新页面入栈 |调用 API uni.navigateTo 、使用组件 <code>&lt;navigator open-type=&quot;navigate&quot;/&gt;</code>|<br>|页面重定向 |当前页面出栈，新页面入栈 |调用 API uni.redirectTo 、使用组件 <code>&lt;navigator open-type=&quot;redirectTo&quot;/&gt;</code>|<br>|页面返回 |页面不断出栈，直到目标返回页 |调用 API uni.navigateBack 、使用组件 <code>&lt;navigator open-type=&quot;navigateBack&quot;/&gt;</code> 、用户按左上角返回按钮、安卓用户点击物理 back 按键|<br>|Tab 切换 |页面全部出栈，只留下新的 Tab 页面 |调用 API uni.switchTab 、使用组件 <code>&lt;navigator open-type=&quot;switchTab&quot;/&gt;</code> 、用户切换 Tab|<br>|重加载 |页面全部出栈，只留下新的页面 |调用 API uni.reLaunch 、使用组件 <code>&lt;navigator open-type=&quot;reLaunch&quot;/&gt;</code>|</p>
<h2 id="pages-json-文件"><a href="#pages-json-文件" class="headerlink" title="pages.json 文件"></a>pages.json 文件</h2><p>pages.json 文件用来对 uni-app 进行全局配置，决定页面文件的路径、窗口样式、原生的导航栏、底部的原生tabbar 等。</p>
<p>它类似微信小程序中app.json的页面管理部分。注意定位权限申请等原属于app.json的内容，在uni-app中是在manifest中配置。</p>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>-</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2020/01/11/20-22-22/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/11/20-22-22/" class="post-title-link" itemprop="url">微信小程序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-01-11 20:22:22" itemprop="dateCreated datePublished" datetime="2020-01-11T20:22:22+08:00">2020-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><ul>
<li>app.json      //配置</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;page&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;page/index/index“，</span></span><br><span class="line"><span class="string">    &quot;</span>page下页面路径“</span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="attr">&quot;window&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">   <span class="comment">// 导航配置</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>app.js  //注册小程序应用</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">App</span>(&#123;.....&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>app.wxss    //全局公共样式</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page&#123;       //小程序会在所有页面加一个page ，因此应设置页面高度为<span class="number">100%</span></span><br><span class="line">           <span class="attribute">height</span>:<span class="number">100%</span>;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>页面：<br>page<br>\index<br>\-index.js  </li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">     <span class="title function_">page</span>(&#123;</span><br><span class="line">     <span class="comment">//初始化数据</span></span><br><span class="line">         <span class="attr">data</span>: &#123;</span><br><span class="line">             <span class="attr">msg</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">             <span class="attr">userInfo</span>:&#123;</span><br><span class="line">                 <span class="comment">//存放用户信息</span></span><br><span class="line">             &#125;,</span><br><span class="line">         &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="comment">//事件绑定</span></span><br><span class="line">        <span class="title function_">handleParent</span>(<span class="params"></span>)&#123;            </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;parent&#x27;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">handleChild</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;child&#x27;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="comment">//跳转至logs页面</span></span><br><span class="line">        <span class="title function_">toLogs</span>(<span class="params"></span>)&#123;                </span><br><span class="line">            <span class="comment">//需要使用api</span></span><br><span class="line">            wx,<span class="title function_">navigateTo</span>(&#123;         <span class="comment">//保留当前页面跳转到另一个页面</span></span><br><span class="line">                <span class="attr">url</span>:<span class="string">&#x27;/page/logs/logs&#x27;</span>,   <span class="comment">//相对路径</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">         <span class="comment">//生命周期函数：监听页面加载，最先执行</span></span><br><span class="line">         <span class="attr">onLoad</span>:<span class="keyword">function</span>(<span class="params">options</span>)&#123;</span><br><span class="line">             <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;onLoad()&#x27;</span>)        <span class="comment">//打印</span></span><br><span class="line"></span><br><span class="line">             <span class="comment">//修改msg数据：this.setData</span></span><br><span class="line">             consile.<span class="title function_">log</span>(<span class="variable language_">this</span>)  <span class="comment">//this表示当前页面的实例对象</span></span><br><span class="line">             consile.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">msg</span>)   </span><br><span class="line">              <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                 <span class="attr">msg</span>:<span class="string">&#x27;after&#x27;</span></span><br><span class="line">             &#125;)</span><br><span class="line"></span><br><span class="line">             <span class="comment">//授权以后获取用户信息</span></span><br><span class="line">             wx.<span class="title function_">gerUserInfo</span>(&#123;</span><br><span class="line">                 <span class="attr">succes</span>:<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                     condole.<span class="title function_">log</span>(res);</span><br><span class="line">                     <span class="comment">//成功后更新数据</span></span><br><span class="line">                     <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                         <span class="attr">userInfo</span>: res.<span class="property">userInfo</span></span><br><span class="line">                     &#125;)</span><br><span class="line">                 &#125;,</span><br><span class="line">                 <span class="attr">fail</span>:<span class="function">() =&gt;</span>&#123;</span><br><span class="line">                     condole.<span class="title function_">log</span>(err);</span><br><span class="line">                 &#125;,</span><br><span class="line">             &#125;)</span><br><span class="line">       &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取用户信息</span></span><br><span class="line">       <span class="title function_">handleGetUserInfo</span>(<span class="params">res</span>)&#123;      <span class="comment">//形参用于判断</span></span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">        <span class="keyword">if</span>(res.<span class="property">detail</span>.<span class="property">userInfo</span>)&#123;</span><br><span class="line">            <span class="comment">//修改userInfo的状态数据</span></span><br><span class="line">            thsi.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                <span class="attr">userInfo</span>: res.<span class="property">detail</span>.<span class="property">userInfo</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">       &#125;,</span><br><span class="line">.....</span><br><span class="line">                 &#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>index.wxml</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;indexcontainer&quot;</span>&gt;</span>   <span class="comment">&lt;!--//样式--&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">wx:if</span>=<span class="string">&#x27;&#123;&#123;userInfo.avatarUrl&#125;&#125;&#x27;</span> <span class="attr">class</span>=<span class="string">&quot;avatarUrl&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;userInfo.avatarUrl&#125;&#125;&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">image</span>&gt;</span>    <span class="comment">&lt;!--图片路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">botton</span> <span class="attr">wx:else</span> <span class="attr">bindgetuserinfo</span>=<span class="string">&#x27;handleGetUserInfo&#x27;</span> <span class="attr">open-type</span>=<span class="string">&quot;getUserInfo&quot;</span>&gt;</span>获取用户信息<span class="tag">&lt;/<span class="name">botton</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;userName&quot;</span>&gt;</span> 文字文字 <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span>    <span class="comment">&lt;!--//使用数据--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--  事件绑定  --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;view class=&quot;hello&quot; bindtap=&quot;handleParent&quot;&gt;  &lt;text bindtap=&#x27;handleChild&#x27;&gt;hello&lt;/text&gt;   &lt;/view&gt;  --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;toLogs&quot;</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">text</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;/<span class="name">view</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>index.wxss      //样式</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">             <span class="selector-class">.indexContainer</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f0f</span>;       <span class="comment">/*只有16进制*/</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.avatarUrl</span>&#123;         <span class="comment">/*头像尺寸样式*/</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200</span>rpx;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">200</span>rpx;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;      <span class="comment">/*圆角*/</span></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">100</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.usrName</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">100</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.hello</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">300</span>rpx;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>:<span class="number">10</span>rpx</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>index.json  </p>
</li>
<li><p>日志：<br>log/logs.json</p>
</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;usingComponens&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;日志“    //最顶部栏文字</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="绑定事件"><a href="#绑定事件" class="headerlink" title="绑定事件"></a>绑定事件</h3><p>bind：冒泡事件<br>catch：非冒泡</p>
<h3 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wx:if=&#x27;条件&#x27;</span><br><span class="line">wx:else</span><br><span class="line">wx:elif=&#x27;条件&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="微信小程序-bindtap-传参"><a href="#微信小程序-bindtap-传参" class="headerlink" title="微信小程序 bindtap 传参"></a>微信小程序 bindtap 传参</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">//index.wxml</span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">bindtap</span>=<span class="string">&quot;changeIndex&quot;</span> <span class="attr">data-src1</span>=<span class="string">&quot;我固定参数1&quot;</span> <span class="attr">data-src2</span>=<span class="string">&quot;我是固定参数2&quot;</span> &gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">//index.js</span><br><span class="line">page(&#123;</span><br><span class="line"> data:&#123;</span><br><span class="line">  </span><br><span class="line"> &#125;,</span><br><span class="line"> changeIndex(e)&#123;</span><br><span class="line"> console.log(e.currentTarget.dataset.src1); //我是固定参数1</span><br><span class="line"> console.log(e.currentTarget.dataset.src2); //我是固定参数2</span><br><span class="line"> &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">////如果需要传递动态的参数 例如遍历渲染时 想传递 index 给 changeIndex方法</span><br><span class="line">//index.wxml</span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;lists&#125;&#125;&quot;</span> <span class="attr">wx:for-index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;index&quot;</span> <span class="attr">data-index</span>=<span class="string">&quot;&#123;&#123;index&#125;&#125;&quot;</span> &gt;</span></span><br><span class="line">&#123;&#123;item.title&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">//index.js</span><br><span class="line">page(&#123;</span><br><span class="line"> data:&#123;</span><br><span class="line"> lists:[&#123;title:&#x27;参数1&#x27;,id:1&#125;,&#123;title:&#x27;参数2&#x27;,id:2&#125;]</span><br><span class="line"> &#125;,</span><br><span class="line"> changeIndex(e)&#123;</span><br><span class="line"> console.log(e.currentTarget.dataset.index);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h3><h3 id="常用功能"><a href="#常用功能" class="headerlink" title="常用功能"></a>常用功能</h3><ol>
<li>导航栏</li>
</ol>
<p>在app.json文件内：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;路径&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;路径&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;window&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tabBar&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;backgroundColor&quot;</span><span class="punctuation">:</span><span class="string">&quot;#f6f6f5&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;list&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span><span class="string">&quot;路径&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span><span class="string">&quot;文字&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span><span class="string">&quot;路径&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span><span class="string">&quot;文字&quot;</span></span><br><span class="line"> </span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>input</li>
</ol>
<p>在index.js文件夹内</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">page</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>:&#123;</span><br><span class="line">        <span class="attr">first</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">second</span>:<span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">first</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> n=e.<span class="property">detail</span>.<span class="property">value</span>;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">isNaN</span>(n))&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                <span class="attr">first</span>:n</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"> <span class="attr">calculate</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> n=<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">first</span>+<span class="number">1</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">second</span>:n</span><br><span class="line">    &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;,</span><br><span class="line">....</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>在index.wxml文件中</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">\<span class="tag">&lt;<span class="name">input</span> <span class="attr">bindinput</span>=<span class="string">&quot;first&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;文字&quot;</span>&gt;</span>\<span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line">\<span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&quot;second&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;文字&quot;</span><span class="attr">disabled</span>&gt;</span>\<span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line">//placeholder：提示</span><br><span class="line">//bindiniput:输入</span><br><span class="line">//bindconfirm:回车触发事件</span><br><span class="line">//value:输入框内容</span><br><span class="line">\<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;search_input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Search&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;text_input&quot;</span> <span class="attr">bindconfirm</span>=<span class="string">&quot;searchtap&quot;</span><span class="attr">value</span>=<span class="string">&quot;&#123;&#123;search_key&#125;&#125;&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">.....</span><br></pre></td></tr></table></figure>

<ul>
<li>textarea</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//auto-focus: 自动聚焦</span><br><span class="line">//maxlength=&quot;-1&quot;:不限长度</span><br><span class="line"> \<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">auto-focus</span> <span class="attr">placeholder</span>=<span class="string">&quot;Text&quot;</span><span class="attr">maxlength</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;text_input&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123;record&#125;&#125;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>选择照片</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">wx.<span class="title function_">chooseImage</span>(&#123;</span><br><span class="line">     <span class="attr">count</span>: <span class="number">1</span>, <span class="comment">//数量 默认9</span></span><br><span class="line">     <span class="attr">sizeType</span>: [<span class="string">&#x27;original&#x27;</span>, <span class="string">&#x27;compressed&#x27;</span>], <span class="comment">//图片质量：原图，压缩</span></span><br><span class="line">     <span class="attr">sourceType</span>: [<span class="string">&#x27;album&#x27;</span>, <span class="string">&#x27;camera&#x27;</span>],      <span class="comment">//拍照，相册</span></span><br><span class="line">     <span class="attr">success</span>: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="comment">//成功后把地址放入全局变量中,</span></span><br><span class="line">       app.<span class="property">data</span>.<span class="property">picpath</span> = res.<span class="property">tempFilePaths</span>[<span class="number">0</span>];</span><br><span class="line">       <span class="comment">//跳转到图片裁剪界面，文字识别界面</span></span><br><span class="line">       wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">         <span class="attr">url</span>: <span class="string">&#x27;/pages/ocr/ocr&#x27;</span>,</span><br><span class="line">       &#125;)</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>跳转界面</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回界面</span></span><br><span class="line">           wx.<span class="title function_">navigateBack</span>(&#123;</span><br><span class="line">             <span class="attr">delta</span>: <span class="number">0</span>,     <span class="comment">//0表示上一层</span></span><br><span class="line">           &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//关闭当前页面跳转到</span></span><br><span class="line"> wx.<span class="title function_">redirectTo</span>(&#123;</span><br><span class="line">   <span class="attr">url</span>: <span class="string">&#x27;/pages/index/index&#x27;</span>,</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>获取列表index</li>
</ul>
<p>wx:for控制属性绑定一个数组进行列表渲染。</p>
<blockquote>
<p>（当前项的下标变量名默认为 index，数组当前项的变量名默认为 item，改名：使用 wx:for-item=“jjj” 可以指定数组当前元素的变量名，<br>使用 wx:for-index =”aa“可以指定数组当前下标的变量名。<br>这个注意了。wx:key还是要加上的，不然一直报这个提示错误：如果列表中项目的位置会动态改变或者有新的项目添加到列表中，并且希望列表中的项目保持自己的特征和状态（如 &lt;input/&gt; 中的输入内容，&lt;switch/&gt; 的选中状态），需要使用 wx:key 来指定列表中项目的唯一的标识符。</p>
</blockquote>
<blockquote>
<p>wx:key 的值以两种形式提供<br>字符串，代表在 for 循环的 array 中 item 的某个 property，该 property 的值需要是列表中唯一的字符串或数字，且不能动态改变。<br>保留关键字 *this 代表在 for 循环中的 item 本身，这种表示需要 item 本身是一个唯一的字符串或者数字，如：<br>当数据改变触发渲染层重新渲染的时候，会校正带有 key 的组件，框架会确保他们被重新排序，而不是重新创建，以确保使组件保持自身的状态，并且提高列表渲染时的效率。如不提供 wx:key，会报一个 warning， 如果明确知道该列表是静态，或者不必关注其顺序，可以选择忽略。）</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wxml:</span><br><span class="line"> <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;touch-item &#123;&#123;item.isTouchMove ? &#x27;touch-move-active&#x27; : &#x27;&#x27;&#125;&#125;&quot;</span> <span class="attr">data-index</span>=<span class="string">&quot;&#123;&#123;index&#125;&#125;&quot;</span> <span class="attr">bindtouchstart</span>=<span class="string">&quot;touchstart&quot;</span> <span class="attr">bindtouchmove</span>=<span class="string">&quot;touchmove&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;item1&#125;&#125;&quot;</span>   <span class="attr">wx:key</span>=<span class="string">&quot;i&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;del&quot;</span> <span class="attr">catchtap</span>=<span class="string">&quot;del&quot;</span> <span class="attr">style</span>=<span class="string">&quot;border-radius:20rpx 0 0 20rpx;&quot;</span>  <span class="attr">data-detail</span>=<span class="string">&quot;&#123;&#123;item.content.text&#125;&#125; &quot;</span> <span class="attr">data-index</span>=<span class="string">&quot;&#123;&#123;index&#125;&#125;&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">view</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">js:</span><br><span class="line"> //列表删除</span><br><span class="line">del(e)&#123;</span><br><span class="line">    this.data.item1.splice(e.currentTarget.dataset.index, 1)</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">     item1: this.data.item1</span><br><span class="line">    &#125;)&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>搜索</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>,j=<span class="number">0</span>;i&lt;app.<span class="property">data</span>.<span class="property">item2</span>.<span class="property">length</span>;i++)&#123;</span><br><span class="line">   <span class="keyword">if</span>(app.<span class="property">data</span>.<span class="property">item2</span>[i].<span class="property">delete</span>==<span class="number">0</span>)&#123;</span><br><span class="line">     <span class="comment">//模糊搜索</span></span><br><span class="line">  <span class="keyword">if</span>(app.<span class="property">data</span>.<span class="property">item2</span>[i].<span class="property">content</span>.<span class="property">text</span>.<span class="title function_">indexOf</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">search_key</span>)!=-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">item1</span>[j]=app.<span class="property">data</span>.<span class="property">item2</span>[i];</span><br><span class="line">    j++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>复制</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*#######复制功能########################*/</span></span><br><span class="line"><span class="attr">copy</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> that = <span class="variable language_">this</span>;</span><br><span class="line">  wx.<span class="title function_">setClipboardData</span>(&#123;</span><br><span class="line">   <span class="attr">data</span>: e.<span class="property">currentTarget</span>.<span class="property">dataset</span>.<span class="property">detail</span>,</span><br><span class="line">   <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>

<ul>
<li>云数据库</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">wx.<span class="property">cloud</span>.<span class="title function_">init</span>(&#123;         <span class="comment">//初始化</span></span><br><span class="line">  <span class="attr">env</span>:<span class="string">&quot;cloud1-3gerlsz2682ceb37&quot;</span>,</span><br><span class="line">  <span class="attr">traceUser</span>:<span class="literal">true</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> db=wx.<span class="property">cloud</span>.<span class="title function_">database</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">Page</span>(&#123; </span><br><span class="line">    <span class="keyword">var</span> that = <span class="variable language_">this</span>;<span class="comment">//定义到这里，让that先获取到外面方法的this</span></span><br><span class="line">    db.<span class="title function_">collection</span>(<span class="string">&#x27;my_data&#x27;</span>).<span class="title function_">where</span>(&#123;<span class="attr">_openid</span>:app.<span class="property">data</span>.<span class="property">useropenid</span>&#125;).<span class="title function_">get</span>(&#123;</span><br><span class="line">      <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">res</span>) &#123;</span><br><span class="line">    <span class="comment">//    that.setData(&#123;item2:res.data[0].array&#125;)</span></span><br><span class="line">    <span class="comment">//用户数据放入全局变量中</span></span><br><span class="line">    app.<span class="property">data</span>.<span class="property">item2</span>=res.<span class="property">data</span>[<span class="number">0</span>].<span class="property">array</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//更新数据 ，添加新条目</span></span><br><span class="line">  db.<span class="title function_">collection</span>(<span class="string">&#x27;my_data&#x27;</span>)</span><br><span class="line">  .<span class="title function_">doc</span>(app.<span class="property">data</span>.<span class="property">useropenid</span>)     <span class="comment">//_id</span></span><br><span class="line">  .<span class="title function_">update</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>:&#123;</span><br><span class="line">     <span class="attr">array</span>: _.<span class="title function_">unshift</span>([&#123;</span><br><span class="line">      <span class="attr">content</span>:&#123;</span><br><span class="line">        <span class="attr">text</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">record</span>,</span><br><span class="line">        <span class="attr">time</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">record_time</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">isTouchMove</span>:<span class="literal">false</span>,</span><br><span class="line">      <span class="attr">delete</span>:<span class="number">0</span></span><br><span class="line">    &#125;])&#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>获取时间</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">util.<span class="property">js</span>:</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">formatTime</span> = date =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> year = date.<span class="title function_">getFullYear</span>()</span><br><span class="line">  <span class="keyword">const</span> month = date.<span class="title function_">getMonth</span>() + <span class="number">1</span></span><br><span class="line">  <span class="keyword">const</span> day = date.<span class="title function_">getDate</span>()</span><br><span class="line">  <span class="keyword">const</span> hour = date.<span class="title function_">getHours</span>()</span><br><span class="line">  <span class="keyword">const</span> minute = date.<span class="title function_">getMinutes</span>()</span><br><span class="line">  <span class="keyword">const</span> second = date.<span class="title function_">getSeconds</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [year, month, day].<span class="title function_">map</span>(formatNumber).<span class="title function_">join</span>(<span class="string">&#x27;-&#x27;</span>) + <span class="string">&#x27; &#x27;</span> + [hour, minute, second].<span class="title function_">map</span>(formatNumber).<span class="title function_">join</span>(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">formatNumber</span> = n =&gt; &#123;</span><br><span class="line">  n = n.<span class="title function_">toString</span>()</span><br><span class="line">  <span class="keyword">return</span> n[<span class="number">1</span>] ? n : <span class="string">&#x27;0&#x27;</span> + n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">formatTime</span>: formatTime</span><br><span class="line">&#125;</span><br><span class="line"> <span class="attr">js</span>:</span><br><span class="line"> <span class="keyword">var</span> util = <span class="built_in">require</span>(<span class="string">&#x27;../../util/util.js&#x27;</span>);</span><br><span class="line"> <span class="title class_">Page</span>(&#123;</span><br><span class="line">  <span class="comment">//获取时间</span></span><br><span class="line">  <span class="keyword">const</span> _ = db.<span class="property">command</span>;</span><br><span class="line">  <span class="keyword">var</span> time = util.<span class="title function_">formatTime</span>(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">    <span class="attr">record_time</span>:time</span><br><span class="line">  &#125;)</span><br><span class="line">  </span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>布局</li>
</ol>
<ul>
<li>固定按钮</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">wxml:</span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;round-click&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;new_goto&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">wxss:</span><br><span class="line">  .round-click&#123;</span><br><span class="line"></span><br><span class="line">    height: 120rpx;</span><br><span class="line"></span><br><span class="line">    width: 120rpx;</span><br><span class="line">    background-color:rgb(246, 246, 246,0.9);</span><br><span class="line">    border-radius: 100%;</span><br><span class="line">    position: fixed;</span><br><span class="line">    bottom: 100rpx;</span><br><span class="line">    right: 20rpx;</span><br><span class="line"></span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line"> font-size:70rpx;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    z-index: 9;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>wx.request发起 HTTPS 网络请求,data请求的参数,success接口调用成功的回调函数 </p>
<p>AudioContext对象用于与audio组件绑定，通过它可以在逻辑层操作视图层的audio组件。可以用wx.createAudioContext(audioId)接口创建并返回audio的上下文对象AudioContext。</p>
<h2 id="跳转"><a href="#跳转" class="headerlink" title="跳转"></a>跳转</h2><ol>
<li>利用小程序提供的 API 跳转：</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 保留当前页面，跳转到应用内的某个页面，使用wx.navigateBack可以返回到原页面。</span></span><br><span class="line"><span class="comment">// 注意：调用 navigateTo 跳转时，调用该方法的页面会被加入堆栈，但是 redirectTo </span></span><br><span class="line">wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;page/home/home?user_id=111&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br><span class="line"><span class="comment">// 关闭当前页面，返回上一页面或多级页面。可通过 getCurrentPages() 获取当前的页面栈，决定需要返回几层。</span></span><br><span class="line"></span><br><span class="line">wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;page/home/home?user_id=111&#x27;</span>　　<span class="comment">// 页面 A</span></span><br><span class="line">&#125;)</span><br><span class="line">wx.<span class="title function_">navigateTo</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;page/detail/detail?product_id=222&#x27;</span>　　<span class="comment">// 页面 B</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 跳转到页面 A</span></span><br><span class="line">wx.<span class="title function_">navigateBack</span>(&#123;</span><br><span class="line">  <span class="attr">delta</span>: <span class="number">2</span></span><br><span class="line">&#125;)</span><br><span class="line">复制代码</span><br><span class="line"><span class="comment">// 关闭当前页面，跳转到应用内的某个页面。</span></span><br><span class="line">wx.<span class="title function_">redirectTo</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;page/home/home?user_id=111&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 跳转到tabBar页面（在app.json中注册过的tabBar页面），同时关闭其他非tabBar页面。</span></span><br><span class="line">wx.<span class="title function_">switchTab</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;page/index/index&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 关闭所有页面，打开到应用内的某个页面。</span></span><br><span class="line">wx.<span class="title function_">reLanch</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;page/home/home?user_id=111&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>原理：wxml中不能直接使用较高级的js语法，如‘.toFixed’，‘toString()’，但可以通过引入wxs模块实现效果</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>新建<span class="string">`filter.wxs`</span></span><br><span class="line"><span class="keyword">var</span> filters = &#123;    </span><br><span class="line">    <span class="attr">toFix</span>: <span class="keyword">function</span> (<span class="params">value</span>) &#123;       </span><br><span class="line">        <span class="keyword">return</span> value.<span class="title function_">toFixed</span>(<span class="number">2</span>) <span class="comment">// 此处2为保留两位小数，保留几位小数，这里写几    </span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">toStr</span>: <span class="keyword">function</span> (<span class="params">value</span>) &#123;       </span><br><span class="line">        <span class="keyword">return</span> value.<span class="title function_">toString</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">toNum</span>: <span class="keyword">function</span> (<span class="params">value</span>) &#123;       </span><br><span class="line">        <span class="keyword">return</span> value.<span class="title function_">toNumber</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;   </span><br><span class="line">    <span class="attr">toFix</span>: filters.<span class="property">toFix</span>,</span><br><span class="line">    <span class="attr">toStr</span>: filters.<span class="property">toStr</span>,</span><br><span class="line">    <span class="attr">toNum</span>: filters.<span class="property">toNum</span>,<span class="comment">//暴露接口调用</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.</span><span class="variable constant_">WXML</span>中引入<span class="variable constant_">WXS</span></span><br><span class="line">&lt;wxs <span class="variable language_">module</span>=<span class="string">&quot;filters&quot;</span> src=<span class="string">&quot;../../utils/filters.wxs&quot;</span>&gt;&lt;/wxs&gt;</span><br><span class="line"><span class="number">3.</span>在<span class="variable constant_">WXML</span>中使用</span><br><span class="line">&lt;view&gt;</span><br><span class="line">&#123;&#123; filters.<span class="title function_">toFix</span>(price) &#125;&#125;</span><br><span class="line">&lt;/view&gt;</span><br><span class="line">　　其他如<span class="title function_">toString</span>(),<span class="title function_">toNumber</span>()也可用此类似方法</span><br></pre></td></tr></table></figure>

<h2 id="虚拟列表"><a href="#虚拟列表" class="headerlink" title="虚拟列表"></a>虚拟列表</h2><ul>
<li>wxml</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">id</span>=<span class="string">&#x27;scrollView&#x27;</span> <span class="attr">style</span>=<span class="string">&quot;margin-top:80rpx;height:calc(100% - 180rpx);&quot;</span> <span class="attr">scroll-y</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">scroll-with-animation</span>=<span class="string">&quot;true&quot;</span> <span class="attr">enable-back-to-top</span>=<span class="string">&quot;true&quot;</span> <span class="attr">refresher-enabled</span>=<span class="string">&quot;true&quot;</span> <span class="attr">refresher-background</span>=<span class="string">&quot;#f6f6f6&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">refresher-triggered</span>=<span class="string">&quot;true&quot;</span> <span class="attr">bindscrolltolower</span>=<span class="string">&quot;listScrollBottom&quot;</span> <span class="attr">bindscrolltoupper</span>=<span class="string">&quot;listScrollTop&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">upper-threshold</span>=<span class="string">&quot;&#123;&#123;listEmptyView+100&#125;&#125;&quot;</span> <span class="attr">lower-threshold</span>=<span class="string">&quot;100&quot;</span> <span class="attr">scroll-top</span>=<span class="string">&quot;&#123;&#123;currentListPosition&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;list.length==0&#125;&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;color:gray;padding:40rpx;&quot;</span>&gt;</span>还没有动态哦，快去发一条吧(。・∀・)ノ<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;listContainer&#123;&#123;index&#125;&#125;&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;list&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.length==undefind&#125;&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height:&#123;&#123;item.height&#125;&#125;px&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:else</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;main_container&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;item&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;i&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">style</span>=<span class="string">&quot;width:100rpx;height:100rpx;border-radius:50%;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.avatar&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;main_container_right&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;main_container_name&quot;</span>&gt;</span>&#123;&#123;item.userName&#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">&quot;display:inline-block;1font-size:30rpx;font-weight:400;color:#536471;&quot;</span>&gt;</span> • &#123;&#123;item.createTime&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 文字 --&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">&quot;padding-left:20rpx;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123;item.content&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 视频 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.hasVideo&amp;&amp;item.url.length!=0&#125;&#125;&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;videoPreview&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;main_container_video&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span> <span class="attr">style</span>=<span class="string">&quot;font-size:100rpx;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-play&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">image</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;!item.hasVideo&amp;&amp;item.url.length==1&#125;&#125;&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">data-current</span>=<span class="string">&quot;0&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span> <span class="attr">class</span>=<span class="string">&quot;main_container_img1&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[0]&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:elif</span>=<span class="string">&quot;&#123;&#123;item.url.length==2&#125;&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;main_container_img2&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;0&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[0]&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;1&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[1]&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:elif</span>=<span class="string">&quot;&#123;&#123;item.url.length==3&#125;&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;main_container_img3&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;0&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[0]&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;main_container_img3_item&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;1&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[1]&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;2&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[2]&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:elif</span>=<span class="string">&quot;&#123;&#123;item.url.length==4&#125;&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;main_container_img4&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;main_container_img4_item&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;0&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">style</span>=<span class="string">&quot; border-radius:  16rpx 0 0 0;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[0]&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;1&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">style</span>=<span class="string">&quot; border-radius:   0 16rpx 0 0;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[1]&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;main_container_img4_item&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;2&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">style</span>=<span class="string">&quot; border-radius:   0 0 0 16rpx ;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[2]&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">bindtap</span>=<span class="string">&quot;imgPreview&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;&#123;&#123;item.url&#125;&#125;&quot;</span> <span class="attr">data-current</span>=<span class="string">&quot;3&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">style</span>=<span class="string">&quot; border-radius:   0  0 16rpx 0;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.url[3]&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--位置--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">style</span>=<span class="string">&quot;margin-top:30rpx;&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.location&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">text</span></span></span><br><span class="line"><span class="tag">                <span class="attr">style</span>=<span class="string">&quot;font-size:25rpx;color:#536471&quot;</span>&gt;</span>位于：<span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;<span class="name">text</span></span></span><br><span class="line"><span class="tag">                <span class="attr">style</span>=<span class="string">&quot;font-size:25rpx;color:#1d9bf0&quot;</span>&gt;</span>&#123;&#123;item.location&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;main_container_bottom&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">data-id</span>=<span class="string">&quot;&#123;&#123;item.id&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-comment&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span>&#123;&#123;item.comments?item.comments:&#x27;&#x27;&#125;&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">data-id</span>=<span class="string">&quot;&#123;&#123;item.id&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-favorite&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">bindtap</span>=<span class="string">&quot;likesUpgrade&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;&#123;&#123;item.id&#125;&#125;&quot;</span> <span class="attr">data-likes</span>=<span class="string">&quot;&#123;&#123;item.likes?item.likes:0&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">text</span></span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">&quot;iconfont icon-fabulous&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span>&#123;&#123;item.likes?item.likes:&#x27;&#x27;&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">data-id</span>=<span class="string">&quot;&#123;&#123;item.id&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-share&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>-js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">    <span class="attr">list</span>: [</span><br><span class="line">      [],</span><br><span class="line">      [],</span><br><span class="line">      []</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">keyword</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">pageNo</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">pageSize</span>: <span class="number">8</span>,</span><br><span class="line">    <span class="attr">total</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">listEmptyView</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">currentListPosition</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">scrollContainerHeight</span>: <span class="number">0</span>,</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">  <span class="title function_">listScrollTop</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> pageNo = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">pageNo</span> - <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (pageNo &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getList</span>(pageNo, <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">pageSize</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">listScrollBottom</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> pageNo = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">pageNo</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pageNo &lt;= <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">total</span> / <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">pageSize</span>)) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getList</span>(pageNo, <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">pageSize</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">getList</span>(<span class="params">pageNo, pageSize</span>) &#123;</span><br><span class="line">    <span class="comment">//获取列表</span></span><br><span class="line">    <span class="title function_">axios</span>(&#123;</span><br><span class="line">      <span class="attr">method</span>: <span class="string">&quot;get&quot;</span>,</span><br><span class="line">      <span class="attr">header</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;Authorization&#x27;</span>: wx.<span class="title function_">getStorageSync</span>(<span class="string">&#x27;Authorization&#x27;</span>),</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&quot;/updates/public?pageNo=&quot;</span> + pageNo + <span class="string">&quot;&amp;pageSize=&quot;</span> + pageSize + <span class="string">&quot;&amp;keyword=&quot;</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(pageNo, pageSize, res);</span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> that = <span class="variable language_">this</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">          <span class="attr">total</span>: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">total</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span> (pageNo &gt;= <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">pageNo</span>) &#123; <span class="comment">//向后翻页</span></span><br><span class="line">          <span class="comment">// wx.createSelectorQuery().select(&#x27;#listContainer1&#x27;).boundingClientRect(function (rect) &#123;&#125;).exec(function (re) &#123;</span></span><br><span class="line">          <span class="comment">//   console.log(that.data.scrollContainerHeight);</span></span><br><span class="line">          <span class="comment">//   that.setData(&#123;</span></span><br><span class="line">          <span class="comment">//     currentListPosition: that.data.listEmptyView  + re[0].height-that.data.scrollContainerHeight+50</span></span><br><span class="line">          <span class="comment">//   &#125;)</span></span><br><span class="line">          <span class="comment">// &#125;)</span></span><br><span class="line">          <span class="keyword">if</span> (pageNo &gt; <span class="number">2</span>) &#123; <span class="comment">//大于两页清除前面</span></span><br><span class="line">            wx.<span class="title function_">createSelectorQuery</span>().<span class="title function_">select</span>(<span class="string">&#x27;#listContainer&#x27;</span> + (pageNo - <span class="number">1</span>)).<span class="title function_">boundingClientRect</span>(<span class="keyword">function</span> (<span class="params">rect</span>) &#123;&#125;).<span class="title function_">exec</span>(<span class="keyword">function</span> (<span class="params">re</span>) &#123; <span class="comment">//空view替代删除的条目</span></span><br><span class="line">              that.<span class="title function_">setData</span>(&#123;</span><br><span class="line">                <span class="attr">listEmptyView</span>: that.<span class="property">data</span>.<span class="property">listEmptyView</span> + re[<span class="number">0</span>].<span class="property">height</span>,</span><br><span class="line">                <span class="attr">pageNo</span>: pageNo,</span><br><span class="line">                [<span class="string">`list[<span class="subst">$&#123;pageNo-<span class="number">2</span>&#125;</span>]`</span>]: &#123;</span><br><span class="line">                  <span class="attr">height</span>: re[<span class="number">0</span>].<span class="property">height</span></span><br><span class="line">                &#125;,</span><br><span class="line">                [<span class="string">`list[<span class="subst">$&#123;pageNo&#125;</span>]`</span>]: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">records</span>,</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">pageNo</span>: pageNo,</span><br><span class="line">              [<span class="string">`list[<span class="subst">$&#123;pageNo&#125;</span>]`</span>]: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">records</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">//向前翻页</span></span><br><span class="line">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">list</span>.<span class="property">length</span> &gt; (pageNo + <span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              [<span class="string">`list[<span class="subst">$&#123;pageNo&#125;</span>]`</span>]: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">records</span>,</span><br><span class="line">              [<span class="string">`list[<span class="subst">$&#123;pageNo+<span class="number">2</span>&#125;</span>]`</span>]: [],</span><br><span class="line">              <span class="attr">pageNo</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">pageNo</span> - <span class="number">1</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              [<span class="string">`list[<span class="subst">$&#123;pageNo&#125;</span>]`</span>]: res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">records</span>,</span><br><span class="line">              <span class="attr">pageNo</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">pageNo</span> - <span class="number">1</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">          wx.<span class="title function_">createSelectorQuery</span>().<span class="title function_">select</span>(<span class="string">&#x27;#listContainer&#x27;</span> + (pageNo)).<span class="title function_">boundingClientRect</span>(<span class="keyword">function</span> (<span class="params">rect</span>) &#123;&#125;).<span class="title function_">exec</span>(<span class="keyword">function</span> (<span class="params">res</span>) &#123; <span class="comment">//缩短占位view高度</span></span><br><span class="line">      </span><br><span class="line">            that.<span class="title function_">setData</span>(&#123;</span><br><span class="line">              <span class="attr">listEmptyView</span>: that.<span class="property">data</span>.<span class="property">listEmptyView</span> - res[<span class="number">0</span>].<span class="property">height</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        wx.<span class="title function_">showToast</span>(&#123;</span><br><span class="line">          <span class="attr">title</span>: res.<span class="property">data</span>.<span class="property">message</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span>,</span><br><span class="line">          <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err == <span class="number">201</span>) &#123;</span><br><span class="line">        wx.<span class="title function_">redirectTo</span>(&#123;</span><br><span class="line">          <span class="attr">url</span>: <span class="string">&#x27;/pages/login/login&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<p>微信小程序中局部更新对象或者数组中的某个数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">[<span class="string">&#x27;list[0][1].a&#x27;</span>]:<span class="number">0</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2020/01/11/20-22-11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/11/20-22-11/" class="post-title-link" itemprop="url">linux常用命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-01-11 20:22:11" itemprop="dateCreated datePublished" datetime="2020-01-11T20:22:11+08:00">2020-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Linux文的权限"><a href="#Linux文的权限" class="headerlink" title="Linux文的权限"></a>Linux文的权限</h2><p>r:4 读；w:2 写；x:1  执行(运行)；－：对应数值0；777：第一个7:表示当前文件的拥有者的权限,第二个7:表示当前文件的所属组（同组用户）权限,第三个7:表示当前文件的组外权限,</p>
<h3 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h3><ol>
<li>Tab键：一下补全，两下提示</li>
<li>简写：<br>若仅输入<code>alias</code>，则可列出目前所有的别名设置。alias的效力仅及于该次登入的操作。若要每次登入是即自动设好别名，可在.profile或.cshrc中设定指令的别名。</li>
</ol>
<p><code>alias 别名=指令名称</code><br>如<code>alias ll=ls -l</code></p>
<ol start="3">
<li>强制关闭程序：<code>kill -9 进程pid</code></li>
<li>修改hosts：<code>sudo vim /etc/hosts</code></li>
<li>退出用户：<code>tty -&gt; w -&gt; sudo pkill -9 tty1</code></li>
</ol>
<h2 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h2><p><code>apt [options] [command] [package ...]</code></p>
<blockquote>
<p>options：可选，选项包括 -h（帮助），-y（当安装过程提示选择全部为”yes”），-q（不显示安装的过程）等等。<br>command：要进行的操作。<br>package：安装的包名。</p>
</blockquote>
<p>常用命令:<br>列出所有可更新的软件清单命令：<code>sudo apt update</code></p>
<p>升级软件包：<code>sudo apt upgrade</code></p>
<p>列出可更新的软件包及版本信息：<code>apt list --upgradeable</code></p>
<p>升级软件包，升级前先删除需要更新软件包：<code>sudo apt full-upgrade</code></p>
<p>安装指定的软件命令：<code>sudo apt install &lt;package_name&gt;</code></p>
<p>更新指定的软件命令：<code>sudo apt update &lt;package_name&gt;</code></p>
<p>显示软件包具体信息,例如：版本号，安装大小，依赖关系等等：<code>sudo apt show &lt;package_name&gt;</code></p>
<p>删除软件包命令：<code>sudo apt remove &lt;package_name&gt;</code></p>
<p>清理不再使用的依赖和库文件:<code>sudo apt autoremove</code></p>
<p>移除软件包及配置文件:<code>sudo apt purge &lt;package_name&gt;</code></p>
<p>查找软件包命令： <code>sudo apt search &lt;keyword&gt;</code></p>
<p>列出所有已安装的包：<code>apt list --installed</code></p>
<p>列出所有已安装的包的版本信息：<code>apt list --all-versions</code></p>
<h3 id="linux-chmod命令"><a href="#linux-chmod命令" class="headerlink" title="linux chmod命令"></a>linux chmod命令</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">u 表示该文件的拥有者，g 表示与该文件的拥有者属于同一个群体(group)者，o 表示其他以外的人，a 表示这三者皆是。</span><br><span class="line">+ 表示增加权限、- 表示取消权限、= 表示唯一设定权限。</span><br><span class="line">r 表示可读取，w 表示可写入，x 表示可执行，X 表示只有当该文件是个子目录或者该文件已经被设定过为可执行。</span><br></pre></td></tr></table></figure>

<p>chmod命令可以使用八进制数来指定权限。文件或目录的权限位是由9个权限位来控制，每三位为一组。例如， 765 将这样解释：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">所有者的权限用数字表达：属主的那三个权限位的数字加起来的总和。如 rwx ，也就是 4+2+1 ，应该是 7。</span><br><span class="line">用户组的权限用数字表达：属组的那个权限位数字的相加的总和。如 rw- ，也就是 4+2+0 ，应该是 6。</span><br><span class="line">其它用户的权限数字表达：其它用户权限位的数字相加的总和。如 r-x ，也就是 4+0+1 ，应该是 5。</span><br></pre></td></tr></table></figure>

<h3 id="find命令"><a href="#find命令" class="headerlink" title="find命令"></a>find命令</h3><p>Linux find 命令用来在指定目录下查找文件。任何位于参数之前的字符串都将被视为欲查找的目录名。如果使用该命令时，不设置任何参数，则 find 命令将在当前目录下查找子目录与文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find   path   -option   [   -<span class="built_in">print</span> ]   [ -<span class="built_in">exec</span>   -ok   <span class="built_in">command</span> ]   &#123;&#125; \;</span><br><span class="line"></span><br><span class="line">-<span class="built_in">type</span> c : 文件类型是 c 的文件。</span><br><span class="line"> -name <span class="string">&quot;*.c&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="ln-命令"><a href="#ln-命令" class="headerlink" title="ln 命令"></a>ln 命令</h3><p>Linux ln（英文全拼：link files）命令是一个非常重要命令，它的功能是为某一个文件在另外一个位置建立一个同步的链接。</p>
<p>当我们需要在不同的目录，用到相同的文件时，我们不需要在每一个需要的目录下都放一个必须相同的文件，我们只要在某个固定的目录，放上该文件，然后在 其它的目录下用ln命令链接（link）它就可以，不必重复的占用磁盘空间<br><code>ln [参数][源文件或目录][目标文件或目录]</code></p>
<blockquote>
<p>必要参数：<br>-b 删除，覆盖以前建立的链接<br>-d 允许超级用户制作目录的硬链接<br>-f 强制执行<br>-i 交互模式，文件存在则提示用户是否覆盖<br>-n 把符号链接视为一般目录<br>-s 软链接(符号链接)<br>-v 显示详细的处理过程</p>
</blockquote>
<h3 id="mv-命令"><a href="#mv-命令" class="headerlink" title="mv 命令"></a>mv 命令</h3><p>Linux mv（英文全拼：move file）命令用来为文件或目录改名、或将文件或目录移入其它位置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> source_directory(目录) dest_directory(目录) </span><br><span class="line">//目录名 dest_directory 已存在，将 source_directory 移动到目录名 dest_directory 中；目录名 dest_directory 不存在则 source_directory 改名为目录名 dest_directory</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参数说明：<br>-b: 当目标文件或目录存在时，在执行覆盖前，会为其创建一个备份。<br>-i: 如果指定移动的源目录或文件与目标的目录或文件同名，则会先询问是否覆盖旧文件，输入 y 表示直接覆盖，输入 n 表示取消该操作。<br>-f: 如果指定移动的源目录或文件与目标的目录或文件同名，不会询问，直接覆盖旧文件。<br>-n: 不要覆盖任何已存在的文件或目录。<br>-u：当源文件比目标文件新或者目标文件不存在时，才执行移动操作。</p>
</blockquote>
<h3 id="rm-命令"><a href="#rm-命令" class="headerlink" title="rm 命令"></a>rm 命令</h3><blockquote>
<p>参数：<br>-i 删除前逐一询问确认。<br>-f 即使原档案属性设为唯读，亦直接删除，无需逐一确认。<br>-r 将目录及以下之档案亦逐一删除。</p>
</blockquote>
<h3 id="cp-命令"><a href="#cp-命令" class="headerlink" title="cp 命令"></a>cp 命令</h3><blockquote>
<p>参数说明：<br>-a：此选项通常在复制目录时使用，它保留链接、文件属性，并复制目录下的所有内容。其作用等于dpR参数组合。<br>-d：复制时保留链接。这里所说的链接相当于Windows系统中的快捷方式。<br>-f：覆盖已经存在的目标文件而不给出提示。<br>-i：与-f选项相反，在覆盖目标文件之前给出提示，要求用户确认是否覆盖，回答”y”时目标文件将被覆盖。<br>-p：除复制文件的内容外，还把修改时间和访问权限也复制到新文件中。<br>-r：若给出的源文件是一个目录文件，此时将复制该目录下所有的子目录和文件。<br>-l：不复制文件，只是生成链接文件。</p>
</blockquote>
<h3 id="which命令"><a href="#which命令" class="headerlink" title="which命令"></a>which命令</h3><p>Linux which命令用于查找文件。</p>
<p>which指令会在环境变量$PATH设置的目录里查找符合条件的文件。</p>
<h3 id="touch命令"><a href="#touch命令" class="headerlink" title="touch命令"></a>touch命令</h3><p>Linux touch命令用于修改文件或者目录的时间属性，包括存取时间和更改时间。若文件不存在，系统会建立一个新的文件。</p>
<blockquote>
<p>参数说明：<br>a 改变档案的读取时间记录。<br>m 改变档案的修改时间记录。<br>c 假如目的档案不存在，不会建立新的档案。与 –no-create 的效果一样。<br>f 不使用，是为了与其他 unix 系统的相容性而保留。<br>r 使用参考档的时间记录，与 –file 的效果一样。<br>d 设定时间与日期，可以使用各种不同的格式。<br>t 设定档案的时间记录，格式与 date 指令相同。<br>–no-create 不会建立新档案。<br>–help 列出指令格式。<br>–version 列出版本讯息。</p>
</blockquote>
<h3 id="mount命令"><a href="#mount命令" class="headerlink" title="mount命令"></a>mount命令</h3><p>Linux mount命令是经常会使用到的命令，它用于挂载Linux系统外的文件。</p>
<blockquote>
<p>参数说明：<br>-V：显示程序版本<br>-h：显示辅助讯息<br>-v：显示较讯息，通常和 -f 用来除错。<br>-a：将 /etc/fstab 中定义的所有档案系统挂上。<br>-F：这个命令通常和 -a 一起使用，它会为每一个 mount 的动作产生一个行程负责执行。在系统需要挂上大量 NFS 档案系统时可以加快挂上的动作。<br>-f：通常用在除错的用途。它会使 mount 并不执行实际挂上的动作，而是模拟整个挂上的过程。通常会和 -v 一起使用。<br>-o remount：将一个已经挂下的档案系统重新用不同的方式挂上。例如原先是唯读的系统，现在用可读写的模式重新挂上。<br>-o ro：用唯读模式挂上。<br>-o rw：用可读写模式挂上。<br>-o loop=：使用 loop 模式用来将一个档案当成硬盘分割挂上系统。<br>-t：指定档案系统的型态，通常不必指定。mount 会自动选择正确的型态。<br>-o async：打开非同步模式，所有的档案读写动作都会用非同步模式执行。<br>-o sync：在同步模式下执行。<br>-o atime、-o noatime：当 atime 打开时，系统会在每次读取档案时更新档案的『上一次调用时间』。当我们使用 flash 档案系统时可能会选项把这个选项关闭以减少写入的次数。</p>
</blockquote>
<p>将 /tmp/image.iso 这个光碟的 image 档使用 loop 模式挂在 /mnt/cdrom之下。用这种方法可以将一般网络上可以找到的 Linux 光 碟 ISO 档在不烧录成光碟的情况下检视其内容。<br><code>#mount -o loop /tmp/image.iso /mnt/cdrom</code></p>
<h3 id="df-命令"><a href="#df-命令" class="headerlink" title="df 命令"></a>df 命令</h3><p>Linux df（英文全拼：disk free） 命令用于显示目前在 Linux 系统上的文件系统磁盘使用情况统计。</p>
<h3 id="mkdir-命令"><a href="#mkdir-命令" class="headerlink" title="mkdir 命令"></a>mkdir 命令</h3><p>Linux mkdir（英文全拼：make directory）命令用于创建目录。</p>
<blockquote>
<p>参数说明：<br>-p 确保目录名称存在，不存在的就建一个。</p>
</blockquote>
<h3 id="logout命令"><a href="#logout命令" class="headerlink" title="logout命令"></a>logout命令</h3><p>Linux logout命令用于退出系统。</p>
<h3 id="passwd命令"><a href="#passwd命令" class="headerlink" title="passwd命令"></a>passwd命令</h3><p><code>passwd [-k] [-l] [-u [-f]] [-d] [-S] [username]</code></p>
<blockquote>
<p>必要参数：<br>-d 删除密码<br>-f 强迫用户下次登录时必须修改口令<br>-w 口令要到期提前警告的天数<br>-k 更新只能发送在过期之后<br>-l 停止账号使用<br>-S 显示密码信息<br>-u 启用已被停止的账户<br>-x 指定口令最长存活期<br>-g 修改群组密码<br>指定口令最短存活期<br>-i 口令过期后多少天停用账户</p>
</blockquote>
<h3 id="Linux系统用户账号的管理"><a href="#Linux系统用户账号的管理" class="headerlink" title="Linux系统用户账号的管理"></a>Linux系统用户账号的管理</h3><p>添加新的用户账号使用useradd命令，其语法如下：<br><code>useradd 选项 用户名</code></p>
<p>删除帐号:<br><code>userdel 选项 用户名 //常用的选项是 -r，它的作用是把用户的主目录一起删除。</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2019/12/08/22-23-45/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/12/08/22-23-45/" class="post-title-link" itemprop="url">Bootloader、Linux内核和文件系统编译</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-12-08 22:23:45" itemprop="dateCreated datePublished" datetime="2019-12-08T22:23:45+08:00">2019-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/experiments/" itemprop="url" rel="index"><span itemprop="name">experiments</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="交叉编译固件及系统测试"><a href="#交叉编译固件及系统测试" class="headerlink" title="交叉编译固件及系统测试"></a>交叉编译固件及系统测试</h1><h2 id="一、目的"><a href="#一、目的" class="headerlink" title="一、目的"></a>一、目的</h2><p>掌握虚拟机软件的安装和配置，掌握Ubuntu系统的安装和配置，掌握交叉编译器的安装，掌握Bootloader、Linux内核和文件系统编译方法，并进行硬件平台系统功能测试。</p>
<h2 id="二、内容"><a href="#二、内容" class="headerlink" title="二、内容"></a>二、内容</h2><p>1、在Windowns环境下安装虚拟机功能软件，在虚拟机环境下安装Ubuntu系统并对系统进行配置。</p>
<p>2、安装ARM交叉编译器，配置环境变量并功能测试。</p>
<p>3、通过对Bootloader、Linux内核和文件系统源码交叉编译，生成系统固件，记录编译结果。</p>
<p>4、调试串口连接硬件平台，对Bootloader和Linux环境下功能命令测试，记录测试结果。</p>
<h2 id="三、设备"><a href="#三、设备" class="headerlink" title="三、设备"></a>三、设备</h2><p>1、主机电脑。2、ARM实验箱3、调试连接配件</p>
<p><strong>四、实验步骤</strong></p>
<p><strong>4.1</strong> Ubuntu系统的安装和配置</p>
<p>下载Ubuntu系统16.04稳定版系统映像，下载地址：</p>
<p><a target="_blank" rel="noopener" href="http://releases.ubuntu.com/16.04.6/?_ga=2.221103960.1120206391.1590239549-144656828.1590239549"><strong>http://releases.ubuntu.com/16.04.6/?_ga=2.221103960.1120206391.1590239549-144656828.1590239549</strong></a></p>
<p>在虚拟机中安装Ubuntu系统，根据自己电脑的配置情况，选择CPU数量和内存大小，硬盘分区大小等配置，安装结果下图所示。(实验室提供华清远见开发环境参考，无需安装系统)</p>
<p>在虚拟机中配置网络适配器模式，理解NAT模式和桥接模式的区别。</p>
<p>开机进入Ubuntu系统，进行网络配置，掌握图形界面和命令行下配置网络方法，理解ifconfig命令的使用方法，</p>
<p>命令行方式下，vmware虚拟机网络方式为桥接模式，为ubuntu系统配置一个静态的IP地址。假设使用的网络地址为192.168.100.X段，默认为ubuntu系统分配的IP地址是192.168.100.192 。</p>
<p>如果想修改ubuntu系统的IP地址，可以执行以下命令，修改文件内容。</p>
<p>linux@ubuntu64-vm:~$ sudo vim /etc/network/interfaces</p>
<p>修改完成后，重新启动网络配置。</p>
<p>linux@ubuntu64-vm:~$ sudo /etc/init.d/networking restart</p>
<p><strong>4. 3 安装交叉编译器并测试</strong></p>
<p>Ubuntu系统中包含四个版本的交叉编译器，位于路径/usr/local/toolchain目录下，不用解压直接使用即可。</p>
<p>修改bash启动文件，执行以下命令：</p>
<p>linux@ubuntu64-vm:~$ sudo vim /etc/bash.bashrc</p>
<p>在bash.bashrc文件最后添加以下内容并保存退出：</p>
<p>export PATH=$PATH:/usr/local/toolchain/toolchain-4.5.1/bin/</p>
<p>再退出bash终端重新打开，执行ARM交叉编译器命令，获取如下信息说明交叉编译器配置完成。</p>
<p>linux@ubuntu64-vm:~$ arm-none-linux-gnueabi-gcc -v</p>
<p><strong>4.4 Linux内核编译</strong></p>
<ol>
<li>首先在虚拟机工作目录下用个人学号建立自己的工作目录。</li>
</ol>
<p>linux@ubuntu64-vm:~$ mkdir /home/linux/2018011222/ -p</p>
<ol>
<li><p>通过U盘或者共享目录将Linux内核源码压缩包拷贝到该目录里面。</p>
</li>
<li><p>拷贝后进入该目录，解压源码。</p>
</li>
</ol>
<p>linux@ubuntu64-vm:~/2018011222$ tar xvf linux-3.4.39.tar.xz</p>
<ol>
<li><p>拷贝ext4文件系统制作工具到/usr/bin目录下。</p>
</li>
<li><p>进入内核源码目录，查看源码结构。</p>
</li>
<li><p>拷贝硬件平台的标准配置文件为.config文件。</p>
</li>
</ol>
<p>$ cp arch/arm/configs/fs6818M4_defconfig_v5 .config</p>
<ol>
<li>执行内核配置命令进入内核配置界面。</li>
</ol>
<p>$ make menuconfig</p>
<p>查看System type和Deviec Driver配置情况，</p>
<ol>
<li>保存退出后，编译内核，编译结果如下图。(比较耗时间，15分钟左右，可以先做4.5小节内容)</li>
</ol>
<p>$ make uImage</p>
<ol>
<li>执行脚本打包内核镜像，内核镜像文件为boot.img，文件格式是ext4格式，其中包括开机LOGO，ramdisk文件系统和uImage内核镜像，生成boot.img文件，</li>
</ol>
<p>$./mkboot.sh</p>
<p><strong>4.5 Linux文件系统镜像制作</strong></p>
<p>1、通过U盘或者共享目录将文件系统源码压缩包拷贝到/source目录下。</p>
<p>解压文件系统源码压缩包，查看文件系统内容。</p>
<p>$tar xvf rootfs.tar.xz</p>
<p>3、将文件系统打包成ext4格式的镜像，生成system_linux.img文件</p>
<p>$make_ext4fs -s system_linux.img -l 300M rootfs</p>
<p><strong>4.6 Bootloader</strong>** 环境测试**</p>
<ol>
<li>连接实验箱5V电源线，连接终</li>
</ol>
<p>端调试串口线和以太网线到电脑主</p>
<p>机，如右图。</p>
<p>(USB OTA调试线烧写镜像用，</p>
<p>可以不连)</p>
<ol>
<li>安装USB转串口驱动程序，确</li>
</ol>
<p>认当前电脑上使用的串口号，设置</p>
<p>电脑上串口调试软件putty。</p>
<ol>
<li>上电启动实验箱，在终端中可以看到启动信息，快速按空格键进入bootloader环境。</li>
<li>通过print、setenv、saveenv等命令测试bootloader，</li>
</ol>
<p><strong>4.7</strong>  <strong>嵌入式</strong>** Linux **<strong>环境测试</strong></p>
<p>按复位键重启硬件系统，等待平台系统进入Linux环境，测试三条Linux命令，</p>
<h1 id="应用程序开发"><a href="#应用程序开发" class="headerlink" title="应用程序开发"></a>应用程序开发</h1><h2 id="一、目的-1"><a href="#一、目的-1" class="headerlink" title="一、目的"></a>一、目的</h2><p>掌握NFS挂载Linux启动方法，掌握Ubuntu 环境下交叉编译应用程序的方法。</p>
<h2 id="二、内容-1"><a href="#二、内容-1" class="headerlink" title="二、内容"></a>二、内容</h2><p>1、使用Vim或者Gedit 文本编译器编写C 语言、汇编语言程序和Makefile文件，分别计算公式3*x2+2*x3 的值和计算4个输入数的平均数。</p>
<p>2、编写Makefile文件，通过make编译得到ARM 可执行程序formula 和average。</p>
<p>3、配置实验箱启动方式为NFS启动，执行并测试程序。</p>
<h2 id="三、设备-1"><a href="#三、设备-1" class="headerlink" title="三、设备"></a>三、设备</h2><p>1、主机电脑。2、ARM实验箱3、调试连接配件</p>
<h2 id="四、原理"><a href="#四、原理" class="headerlink" title="四、原理"></a>四、原理</h2><p>掌握嵌入式Linux 应用开发所用到的一些常用工具，包括编辑工具vim、gedit、编译工具gcc、MakeFile 文件及调试工具gdb。</p>
<p>正确掌握C 语言、汇编语言程序和Makefile编写语法和格式。</p>
<h2 id="五、步骤"><a href="#五、步骤" class="headerlink" title="五、步骤"></a>五、步骤</h2><h3 id="5-1-计算公式3-x-2-2-x3"><a href="#5-1-计算公式3-x-2-2-x3" class="headerlink" title="5.1 计算公式3*x^2+2*x3"></a>5.1 计算公式3*x^2+2*x3</h3><p>1、在Linux 主机上进入自己学号的工作目录，执行如下命令。</p>
<p>$cd /home/linux/2018011222/</p>
<p>$mkdir exam1</p>
<p>$cd exam1</p>
<p>$ gedit formula.c</p>
<ol>
<li>在formula.c 程序里面输入以下内容。</li>
</ol>
<p>#include&amp;lt;stdio.h&amp;gt;</p>
<p>extern int compute(int data);</p>
<p>int main()</p>
<p>{</p>
<p>int x;</p>
<p>printf(&quot;Input x=&quot;);</p>
<p>scanf(&quot;%d&quot;,&amp;x);</p>
<p>printf(&quot;The result is %d\n&quot;,compute(x));</p>
<p>return 0;</p>
<p>}</p>
<p>3、执行命令生成汇编文件</p>
<p>$ gedit compute.S</p>
<p>包含计算3*x^2+2*x^3过程的汇编文件为compute.S内容如下:.text</p>
<p>.align</p>
<p>.global compute</p>
<p>compute:</p>
<p>stmfd sp!,{r4-r11,r14}</p>
<p>mul r1,r0,r0</p>
<p>mov r3,#2</p>
<p>mul r2,r1,r3</p>
<p>mov r3,#3</p>
<p>mul r4,r1,r3</p>
<p>mla r0,r2,r0,r4</p>
<p>ldmfd sp!,{r4-r11,r15}</p>
<p>4、自行编写Makefile 文件，实现对c语言程序和汇编程序的编译得到formula可执行程序。</p>
<p>5、在exam1目录下执行make命令得到可执行文件formula</p>
<p>$make</p>
<p>6、应用strip工具精简可执行程序</p>
<p>$arm-none-linux-gnueabi-strip formula</p>
<p>7、file命令可以查看formula程序属性，截图保存formula程序信息到实验报告中。</p>
<p>$file formula</p>
<h3 id="5-2-计算4-个数的平均值"><a href="#5-2-计算4-个数的平均值" class="headerlink" title="5.2 计算4 个数的平均值"></a>5.2 计算4 个数的平均值</h3><p>1、在Linux 主机上建立工作目录，执行如下命令。</p>
<p>$cd /home/linux/2018011222/</p>
<p>$mkdir exam2</p>
<p>$cd exam2</p>
<p>$gedit avg.c</p>
<ol>
<li>在avg.c程序里面输入以下内容。</li>
</ol>
<p>#include&amp;lt;stdio.h&amp;gt;</p>
<p>extern int average(int i, int j,int k,int l);</p>
<p>int main(void)</p>
<p>{</p>
<p>int a,b,c,d,avr;</p>
<p>printf(&quot;Input 4 number: \n&quot;);</p>
<p>scanf(&quot;%d&quot;,&amp;a);</p>
<p>scanf(&quot;%d&quot;,&amp;b);</p>
<p>scanf(&quot;%d&quot;,&amp;c);</p>
<p>scanf(&quot;%d&quot;,&amp;d);</p>
<p>printf(&quot;a=%d,b=%d,c=%d,d=%d\n&quot;,a,b,c,d);</p>
<p>avr= average(a,b,c,d);</p>
<p>printf(&quot;(%d+,%d+,%d+,%d)/4=,%d\n&quot;,a,b,c,d,avr);</p>
<p>return 0;</p>
<p>}</p>
<p>3、执行命令生成汇编文件</p>
<p>$gedit average.S</p>
<p>自行编写计算平均值的汇编文件average.S程序。</p>
<p>4、自行编写Makefile 文件，实现对c语言程序和汇编程序的编译得到formula可执行程序。</p>
<p>5、在exam2目录下执行make命令得到可执行文件average</p>
<p>$make</p>
<p>6、应用strip工具精简可执行程序</p>
<p>$ arm-none-linux-gnueabi-strip average</p>
<p>7、file命令可以查看average程序属性，</p>
<p>$file average</p>
<h3 id="5-3配置NFS启动方式"><a href="#5-3配置NFS启动方式" class="headerlink" title="5.3配置NFS启动方式"></a>5.3配置NFS启动方式</h3><p>1、设置好电脑主机的IP地址为192.168.100.192 ，配置好主机的NFS服务，默认是启动的。</p>
<p>2、在Bootloader环境下配置启动参数， <strong>注意格式不要出错！！！</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FS6818# setenv serverip 192.168.100.192</span><br><span class="line"></span><br><span class="line">FS6818#setenv ipaddr 192.168.100.100</span><br><span class="line"></span><br><span class="line">FS6818# setenv gatewayip 192.168.100.1</span><br><span class="line"></span><br><span class="line">FS6818# setenv bootcmd ext4load mmc 2:1 0x48000000 uImage\;bootm 0x48000000</span><br><span class="line"></span><br><span class="line">FS6818# setenv bootargs root=/dev/nfs nfsroot=192.168.100.192:/source/rootfs console=ttySAC0,115200 init=/linuxrc ip=192.168.100.100:::::eth0:off</span><br><span class="line"></span><br><span class="line">FS6818# saveenv</span><br></pre></td></tr></table></figure>

<p>保存后复位ARM实验箱，等待进入NFS启动的文件系统，如下图。</p>
<p><img src="RackMultipart20210826-4-1d1i54l_html_ea6ac7d22326c54c.png"></p>
<p>拷贝之前编译好的可执行文件formula和average到主机NFS共享目录下wsn6818bp_test，这样在putty终端中就可以运行测试结果，</p>
<p><img src="RackMultipart20210826-4-1d1i54l_html_458a03b2d32152d4.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2019/11/28/19-22-34/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/28/19-22-34/" class="post-title-link" itemprop="url">调用百度语音识别api</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-28 19:22:34" itemprop="dateCreated datePublished" datetime="2019-11-28T19:22:34+08:00">2019-11-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">嵌入式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="注册账号申请api-key"><a href="#注册账号申请api-key" class="headerlink" title="注册账号申请api key"></a>注册账号申请api key</h3><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>源码：语音识别、语音合成</li>
</ul>
<p><code>git clone https://github.com/Baidu-AIP/speech-demo</code></p>
<ul>
<li>依赖(curl.h)：</li>
</ul>
<p><code>apt install libcurl4-openssl-dev</code></p>
<h3 id="编辑源文件"><a href="#编辑源文件" class="headerlink" title="编辑源文件"></a>编辑源文件</h3><p>编辑<code>asrmain.c</code> <code>ttsmain.c</code>填入自己的keys，修改相应参数</p>
<p>编译<code>sh build_xxxxxxx</code></p>
<h2 id="语音唤醒"><a href="#语音唤醒" class="headerlink" title="语音唤醒"></a>语音唤醒</h2><h3 id="snowboy下载"><a href="#snowboy下载" class="headerlink" title="snowboy下载"></a>snowboy下载</h3><p><code>git clone https://github.com/Kitt-AI/snowboy.git</code></p>
<h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><p><code>sudo apt-get -y install libasound2-dev</code><br><code>sudo apt-get install python3-pyaudio</code><br><code>sudo apt-get install swig3.0 sox</code><br><code>sudo apt-get install libatlas-base-dev</code>  </p>
<p>通过ffplay工具(安装ffmpeg会带上这个工具)。</p>
<p><code>ffplay -ar 44100 -channels 2 -f s16le -i 123.pcm</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2019/11/22/22-33-33/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/22/22-33-33/" class="post-title-link" itemprop="url">C语言常见例题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-22 22:33:33" itemprop="dateCreated datePublished" datetime="2019-11-22T22:33:33+08:00">2019-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/study/" itemprop="url" rel="index"><span itemprop="name">study</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><hr>
<ul>
<li>求闰年</li>
</ul>
<p>能被4整除且不能被100整除,或能够被400整除的年份就是闰年</p>
<hr>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2019/11/22/22-11-33/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/22/22-11-33/" class="post-title-link" itemprop="url">Alsa库移植和安装</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-22 22:11:33" itemprop="dateCreated datePublished" datetime="2019-11-22T22:11:33+08:00">2019-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">嵌入式</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="alsa库下载"><a href="#alsa库下载" class="headerlink" title="alsa库下载"></a>alsa库下载</h3><p><code>ftp://ftp.alsa-project.org/pub</code></p>
<h3 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h3><p>解压进入文件夹<br><code>./configure  --prefix=/home/mine/alsa //生成文件存放的位置</code><br>开始安装驱动<br><code>make &amp;&amp; sudo make install</code></p>
<h3 id="交叉编译"><a href="#交叉编译" class="headerlink" title="交叉编译"></a>交叉编译</h3><p>使用命令</p>
<p><code>./configure --host=arm-jyxtec-linux-gnueabi --prefix=/usr/share/arm-alsa</code></p>
<blockquote>
<p>–host参数指定了交叉编译器为“arm-jyxtec-linux-gnueabi（根据自己板子上的工具链稳准）”，因此必须确保交叉编译器已成功配置（也就是已经导出为全局环境变量，切记！切记！我就在这浪费了很多时间，我的习惯是添加据对路径），且可以在shell里直接调用；–prefix参数指定了alsa-lib的目标安装目录，之后的alsa-util配置也一样</p>
</blockquote>
<p>使用命令</p>
<p><code>./configure --host=arm-jyxtec-linux-gnueabi --prefix=/usr/share/arm-alsa --with-alsa-inc-prefix=/usr/share/arm-alsa/include --with-alsa-prefix=/usr/share/arm-alsa/lib --disable-alsamixer --disable-xmlto</code></p>
<blockquote>
<p>–with-alsa-inc-prefix和–with-alsa-prefix分别指定了交叉编译util应用所需要的alsa-lib的头文件和库文件；–disable-alsamixer表示不编译生成alsamixer这个应用程序，因为该程序依赖于ncurses这个图形界面库，目前我们对于该库还不能交叉编译，故放弃</p>
</blockquote>
<h3 id="可能出现的错误"><a href="#可能出现的错误" class="headerlink" title="可能出现的错误"></a>可能出现的错误</h3><hr>
<p><code>error: this packages requires a curses library</code>  </p>
<p><strong>解决办法：</strong>  </p>
<p><code>apt-get install libncurses5-dev</code></p>
<hr>
<p><code>error: panelw library not found</code>  </p>
<p><strong>解决办法：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">ln</span> -s libpanelw.so.5 /usr/lib/libpanelw.so</span><br><span class="line">sudo <span class="built_in">ln</span> -s libformw.so.5 /usr/lib/libformw.so</span><br><span class="line">sudo <span class="built_in">ln</span> -s libmenuw.so.5 /usr/lib/libmenuw.so</span><br><span class="line">sudo <span class="built_in">ln</span> -s libncursesw.so.5 /lib/libncursesw.so</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>解决办法：</strong></p>
<p>根据自己的错误提示来输入命令  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果提示是t-ru.gmo的话，就用命令：touch alsaconf/po/t-ru.gmo</span><br><span class="line">如果提示是t-ja.gmo的话，就用命令：touch alsaconf/po/t-ja.gmo</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2019/11/21/11-22-12/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/21/11-22-12/" class="post-title-link" itemprop="url">C++</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-21 11:22:12" itemprop="dateCreated datePublished" datetime="2019-11-21T11:22:12+08:00">2019-11-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/study/" itemprop="url" rel="index"><span itemprop="name">study</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Helloword"><a href="#Helloword" class="headerlink" title="Helloword"></a>Helloword</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std; <span class="comment">//名字空间</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;helo word&quot;</span>&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;helo word\n&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h3><p>cin、cout是istream类的对象</p>
<h3 id="重载"><a href="#重载" class="headerlink" title="重载"></a>重载</h3><h3 id="复杂的数据类型"><a href="#复杂的数据类型" class="headerlink" title="复杂的数据类型"></a>复杂的数据类型</h3><h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>定义构造器<br>构造器的名字必须与它所在的类的名字一样<br>构造器没有返回值  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"> <span class="built_in">Car</span>(<span class="type">void</span>); <span class="comment">//名称与类名一致</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Car::<span class="built_in">Car</span>(<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">xxx</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">调用：</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"> <span class="built_in">Car</span>(<span class="type">void</span>); <span class="comment">//名称与类名一致</span></span><br><span class="line"> <span class="function"><span class="type">void</span> <span class="title">runing</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Car::<span class="built_in">Car</span>(<span class="type">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">xxx</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">runing</span><span class="params">()</span></span>&#123;</span><br><span class="line">xxx</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span></span>&#123;</span><br><span class="line">Car mycar;</span><br><span class="line">mycar.<span class="built_in">runing</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>数组：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Car mycar[<span class="number">10</span>];</span><br><span class="line">调用：</span><br><span class="line">mycar[x].runing; <span class="comment">//x为给定数组元素的下标</span></span><br></pre></td></tr></table></figure>

<p>副本构造器</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MyClass（<span class="type">const</span> MyClass &amp;rhs);</span><br></pre></td></tr></table></figure>

<p>析构器：与构造器一样，只是前边多了一个波浪符<code>~</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Car</span>(<span class="type">void</span>);</span><br><span class="line">~<span class="built_in">Car</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Car::<span class="built_in">Car</span>()</span><br><span class="line">&#123;</span><br><span class="line">xxx</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Car::~<span class="built_in">Car</span>()&#123;</span><br><span class="line">xxx</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>this指针:让构造器知道哪个是参数哪个是属性</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果代码中不存在二义性，则不必使用this指针</span></span><br><span class="line"><span class="keyword">this</span>-&gt;fish=fish;</span><br></pre></td></tr></table></figure>

<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>基类即父类<br>子类即从基类派生出来的类</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">class</span> <span class="title">SubCar</span><span class="params">(子类)</span>:public Car(基类) &#123;</span>...&#125;;</span><br><span class="line">子类也可以调用基类的成员</span><br></pre></td></tr></table></figure>

<ul>
<li>继承里的含参数构造器</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Animal</span>(std::string Name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pig</span>:<span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Pig</span>(std::string Name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造器</span></span><br><span class="line">Animal::<span class="built_in">Animal</span>(std::string Name)</span><br><span class="line">&#123;</span><br><span class="line">name=Name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Pig::<span class="built_in">Pig</span>(std::string Name) : <span class="built_in">Animal</span>(Name)</span><br><span class="line">&#123;</span><br><span class="line">xxx</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h3><p>保护类里的方法和属性的手段</p>
<blockquote>
<p>public：任何代码<br>protected：这个类本身和它的子类<br>private：只有这个类本身</p>
</blockquote>
<h3 id="覆盖方法"><a href="#覆盖方法" class="headerlink" title="覆盖方法"></a>覆盖方法</h3><p>在类里重新声明这个方法</p>
<h3 id="重载-1"><a href="#重载-1" class="headerlink" title="重载"></a>重载</h3><p>可以定义多个同名的函数，只要它们输入的参数不同</p>
<ul>
<li>运算符的重载</li>
</ul>
<p>重载不能改变运算符的操作个数，优先级，结核性</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">函数类型 <span class="keyword">operator</span> 运算符（形参）</span><br><span class="line">&#123;</span><br><span class="line">运算符的重载操作</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如：</span><br><span class="line"><span class="type">int</span> <span class="keyword">operator</span> +(<span class="type">int</span> a,<span class="type">int</span> b)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> (a-b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>以下五个运算符不允许重载：<br><code>.</code>;<code>*</code>;<code>::</code>;<code>sizeof</code>;<code>?:</code>;</p>
</blockquote>
<h3 id="友元关系"><a href="#友元关系" class="headerlink" title="友元关系"></a>友元关系</h3><p>友元关系是类中的一种特殊关系，允许友元类访问对方pubulic、protected、private中的方法和属性</p>
<p>只要在类的声明里的地方加上<code>friend class **类名字***</code></p>
<h3 id="静态属性和静态方法"><a href="#静态属性和静态方法" class="headerlink" title="静态属性和静态方法"></a>静态属性和静态方法</h3><p>只要在它的声明前加上<code>static</code>即可</p>
<h3 id="虚方法"><a href="#虚方法" class="headerlink" title="虚方法"></a>虚方法</h3><p>只需要在其原型前加上<code>virtual</code>即可</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">每一个<span class="keyword">new</span>操作都要对应一个<span class="keyword">delete</span>操作</span><br><span class="line"><span class="type">int</span> *p=<span class="keyword">new</span> <span class="type">int</span>;</span><br><span class="line">*p=<span class="number">10</span>;</span><br><span class="line">std::cout&lt;&lt;*p;</span><br><span class="line"><span class="keyword">delete</span> p;</span><br></pre></td></tr></table></figure>

<h3 id="抽象方法"><a href="#抽象方法" class="headerlink" title="抽象方法"></a>抽象方法</h3><p>在原型的末尾加上<code>=0</code></p>
<h3 id="多继承"><a href="#多继承" class="headerlink" title="多继承"></a>多继承</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TeachingStudent</span>:<span class="keyword">public</span> Student,<span class="keyword">public</span> Teacher</span><br><span class="line">&#123;</span><br><span class="line">xxxx</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="虚继承"><a href="#虚继承" class="headerlink" title="虚继承"></a>虚继承</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Teacher</span>:<span class="keyword">virtual</span> <span class="keyword">public</span> Person</span><br><span class="line">&#123;</span><br><span class="line">xxx</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="动态内存"><a href="#动态内存" class="headerlink" title="动态内存"></a>动态内存</h3><p>new语句申请内存，delete语句释放内存,再将指针指向NULL</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *i=<span class="keyword">new</span> <span class="type">int</span>;</span><br><span class="line"><span class="keyword">delete</span> i;</span><br><span class="line">i=<span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>动态数组</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *=<span class="keyword">new</span> <span class="type">int</span>[<span class="number">10</span>];</span><br><span class="line">x[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">....</span><br><span class="line"><span class="keyword">delete</span> [] x; <span class="comment">//删除动态数组</span></span><br></pre></td></tr></table></figure>

<h3 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h3><p>静态：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Company *company=<span class="keyword">new</span> <span class="built_in">Company</span>(<span class="string">&quot;APPLE&quot;</span>,<span class="string">&quot;iPhone&quot;</span>);</span><br><span class="line">TechCompany *tecCompany=(TecCompany*)company</span><br><span class="line"><span class="keyword">delete</span> company;</span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 不能两个都删除</span></span><br><span class="line">company=<span class="literal">NULL</span>;</span><br><span class="line">tecCompany=<span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>

<p>动态：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">const_cast</span>&lt;MyClass*&gt;(value) <span class="comment">//用来改变value的常量性</span></span><br><span class="line"><span class="built_in">dynamic_cast</span>&lt;MyClass*&gt;(value) <span class="comment">//用来把一中类型的对象指针安全地强制转换为另一种类型的对象指针，如果value的类型不是一个MyClass类或其子类的指针，则返回NULL</span></span><br><span class="line"><span class="built_in">reinterpret_cast</span>&lt;T&gt;(value) <span class="comment">//在不进行任何实质性的转换的情况下，把一种类型的指针解释为另一种类型的指针或者把一种整数解释为另一种整数</span></span><br><span class="line"><span class="built_in">static_cast</span>&lt;T&gt;(value)  <span class="comment">//用来进行强制类型转换而不做任何运行时的检查</span></span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">Company *company=<span class="keyword">new</span> <span class="built_in">Company</span>(<span class="string">&quot;APPLE&quot;</span>,iPhone<span class="string">&quot;);</span></span><br><span class="line"><span class="string">TechCompany *techcompany=dynamic_cast&lt;TechCompany *&gt;(company);</span></span><br></pre></td></tr></table></figure>

<h3 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> myNamespace</span><br><span class="line">&#123;</span><br><span class="line">....</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用命名空间</span></span><br><span class="line">* <span class="keyword">using</span> <span class="keyword">namespace</span> myNamespace</span><br><span class="line"></span><br><span class="line">* myNamespace::xxxx</span><br><span class="line"></span><br><span class="line">* <span class="keyword">using</span> std::cout;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;,,,,&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><p>当使用编译器建立程序时：<br>1.执行预处理器指令<br>2.把.cpp文件编译成.o文件<br>3.把.o文件链接成一个可执行文件  </p>
<h3 id="泛型编程"><a href="#泛型编程" class="headerlink" title="泛型编程"></a>泛型编程</h3><p>函数模板</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="comment">//字母T表示接下来的函数里代表的一种不确定的数据类型</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(T &amp;a,T &amp;b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">T i=<span class="number">0</span>;</span><br><span class="line">....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>类模板</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">MyClass</span>();</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(T &amp;a,T &amp;b)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造器的实现</span></span><br><span class="line">Myclass&lt;T&gt;::<span class="built_in">MyClass</span>()</span><br><span class="line">&#123;</span><br><span class="line">.....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="内联函数"><a href="#内联函数" class="headerlink" title="内联函数"></a>内联函数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">add</span> <span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> x+Y+z;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2019/11/12/22-23-33/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/12/22-23-33/" class="post-title-link" itemprop="url">wifiDog</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-12 22:23:33" itemprop="dateCreated datePublished" datetime="2019-11-12T22:23:33+08:00">2019-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="wifiDog"><a href="#wifiDog" class="headerlink" title="wifiDog"></a>wifiDog</h1><p>首先简介一下什么是Portal认证。Portal认证。通常也会叫Web认证。未认证用户上网时，设备强制用户登录到特定站点，用户能够免费訪问当中的服务。当用户须要使用互联网中的其他信息时，必须在门户站点进行认证。仅仅有认证通过后才干够使用互联网资源。</p>
<p>现金非常多中国移动CMCC、中国联通、中国电信ChinaNet的WIFI都使用这样的认证接入方式。</p>
<p>在OpenWRT上实现Portal认证，实际上早已有解决方式：</p>
<ol>
<li>chillispot，但原维护作者停止更新。被chillispot.info接管继续开发；</li>
</ol>
<p>2.coova-chilli，它是基于chillispot开发拓展的，功能最为强大；能够去官方看一下Coova-chilli；</p>
<p>3.wifidog</p>
<p>前两个因为原维护作者停止更新。笔者也没有深入研究，重点钻研了wifidog，Wifidog也是OpenWRT和DD-WRT中实现Portal比較出名的。</p>
<p>可是。Wifidog仅仅是实现AP认证网关，须要配合外部的Portalserver才干使用。Portal主要是提供认证所需的WEB页面且实现认证计费等的功能。尽管这也有非常多商用解决方式，比如wiwiz、wifiap等，可是这些商业解决方式的目标都是盈利。即使能够免费使用。免费账号的功能和权限都受到了非常大的限制，比如不能自己定义页面。Web认证页面有广告等等。有条件的人可能打算自己搭建Portalserver。可是看看Wifidog的官方Wiki。对搭建过程实在是难以理解。后来，笔者发现网络上另一个authpuppy方案，官方站点<a target="_blank" rel="noopener" href="http://www.authpuppy.org.是一个已实现好的wifidog认证server,里面包括各种插件供你使用,官方的安装过程也非常easy,假设你懂的html和面向对象编程的相关知识且拥有一个server,能够自行改动认证页面.使用authpuppy也是一个不错的方案./">www.authpuppy.org。是一个已实现好的Wifidog认证server，里面包括各种插件供你使用，官方的安装过程也非常easy，假设你懂的HTML和面向对象编程的相关知识且拥有一个server，能够自行改动认证页面。使用authpuppy也是一个不错的方案。</a></p>
<p>可是。即便如此，这些方案还是不够灵活，经过笔者认真钻研。查阅大量资料并经过多次抓包分析，最终理解了Wifidog的工作原理。</p>
<p>接下来笔者将会跟你介绍怎样自行编写一个轻量级的Web Portal认证server。当然。这须要你具有程序设计基础，HTML、CSS当然是少不得的。后端开发语言能够使用PHP或Python或Java等。</p>
<p>首先，须要简介一下Wifidog的工作原理：</p>
<p>1.client发出初始化请求，比方訪问 <a target="_blank" rel="noopener" href="http://www.baidu.com./">www.baidu.com。</a></p>
<p>2.网关的防火墙规则将这个请求重定向到本地网关的port上。这个port是Wifidog监听的port。</p>
<p>3.Wfidog提供一个HTTP重定向回复，重定向到Web认证页面。重定向的Url的Querystring中包括了Gateway的ID，Gateway的FQDN以及其它的信息。</p>
<p>4.用户向认证server发出认证请求</p>
<p><a href="http://portal_server:port/login_script">http://portal_server:port/login_script</a>?</p>
<p>gw_id=[GatewayID, default: “default”]</p>
<p>gw_address=[GatewayAddress, internal IP of router]</p>
<p>gw_port=[GatewayPort, port that wifidog Gateway is listening on]</p>
<p>url=[user requested url]；</p>
<p>5.网关返回一个（能够是自己定义的）splash（也称作“登录”）页面。</p>
<p>6.用户提供他的凭据信息，比方username和password。</p>
<p>7.成功认证的话，client将会被重定向到网关的自己的web页面上，而且带有一个认证凭据（一个一次性的token），内容比方：</p>
<p><a href="http://GatewayIP:GatewayPort/wifidog/auth?token=[auth">http://GatewayIP:GatewayPort/wifidog/auth?token=[auth</a> token]；</p>
<p>8.用户就是用获取到的凭据訪问网关。</p>
<p>9.网关去认证server询问token的有效性。</p>
<p>10.认证server确认token的有效性。</p>
<p>11.网关发送重定向给client。以从认证服务器上获取 成功提示页面，重定向到 <a href="http://portal_server:port/portal_script">http://portal_server:port/portal_script</a> 这个位置。</p>
<p>12.认证server通知客户请求成功，能够上网了。</p>
<p>图解:</p>
<p>图解Wifidog工作原理</p>
<p>然后考察一下Wifidog的配置文件/etc/wifidog.conf，关键的配置项是：</p>
<p>AuthServer {</p>
<p>Hostname             (Mandatory; Default: NONE)</p>
<p>SSLAvailable           (Optional; Default: no; Possible values: yes, no)</p>
<p>SSLPort               (Optional; Default: 443)</p>
<p>HTTPPort             (Optional; Default: 80)</p>
<p>Path                  (Optional; Default: /wifidog/ Note:  The path must be both prefixed and suffixed by /.  Use a single / for server root.)</p>
<p>LoginScriptPathFragment  (Optional; Default: login/?</p>
<p>Note:  This is the script the user will be sent to for login.)</p>
<p>PortalScriptPathFragment (Optional; Default: portal/? Note:  This is the script the user will be sent to after a successfull login.)</p>
<p>MsgScriptPathFragment    (Optional; Default: gw_message.php? Note:  This is the script the user will be sent to upon error to read a readable message.)</p>
<p>PingScriptPathFragment    (Optional; Default: ping/?</p>
<p>Note:  This is the script the user will be sent to upon error to read a readable message.)</p>
<p>AuthScriptPathFragment    (Optional; Default: auth/?</p>
<p>Note:  This is the script the user will be sent to upon error to read a readable message.)</p>
<p>}</p>
<h1 id="Listen-on-this-port"><a href="#Listen-on-this-port" class="headerlink" title="Listen on this port"></a>Listen on this port</h1><p>GatewayPort 2060</p>
<h1 id="Parameter-CheckInterval"><a href="#Parameter-CheckInterval" class="headerlink" title="Parameter: CheckInterval"></a>Parameter: CheckInterval</h1><h1 id="Default-60"><a href="#Default-60" class="headerlink" title="Default: 60"></a>Default: 60</h1><h1 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h1><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="How-many-seconds-should-we-wait-between-timeout-checks-This-is-also"><a href="#How-many-seconds-should-we-wait-between-timeout-checks-This-is-also" class="headerlink" title="How many seconds should we wait between timeout checks.  This is also"></a>How many seconds should we wait between timeout checks.  This is also</h1><h1 id="how-often-the-gateway-will-ping-the-auth-server-and-how-often-it-will"><a href="#how-often-the-gateway-will-ping-the-auth-server-and-how-often-it-will" class="headerlink" title="how often the gateway will ping the auth server and how often it will"></a>how often the gateway will ping the auth server and how often it will</h1><h1 id="update-the-traffic-counters-on-the-auth-server-Setting-this-too-low"><a href="#update-the-traffic-counters-on-the-auth-server-Setting-this-too-low" class="headerlink" title="update the traffic counters on the auth server.  Setting this too low"></a>update the traffic counters on the auth server.  Setting this too low</h1><h1 id="wastes-bandwidth-setting-this-too-high-will-cause-the-gateway-to-take"><a href="#wastes-bandwidth-setting-this-too-high-will-cause-the-gateway-to-take" class="headerlink" title="wastes bandwidth, setting this too high will cause the gateway to take"></a>wastes bandwidth, setting this too high will cause the gateway to take</h1><h1 id="a-long-time-to-switch-to-it’s-backup-auth-server-s"><a href="#a-long-time-to-switch-to-it’s-backup-auth-server-s" class="headerlink" title="a long time to switch to it’s backup auth server(s)."></a>a long time to switch to it’s backup auth server(s).</h1><p>CheckInterval 60</p>
<h1 id="Parameter-ClientTimeout"><a href="#Parameter-ClientTimeout" class="headerlink" title="Parameter: ClientTimeout"></a>Parameter: ClientTimeout</h1><h1 id="Default-5"><a href="#Default-5" class="headerlink" title="Default: 5"></a>Default: 5</h1><h1 id="Optional-1"><a href="#Optional-1" class="headerlink" title="Optional"></a>Optional</h1><h1 id="-1"><a href="#-1" class="headerlink" title=""></a></h1><h1 id="Set-this-to-the-desired-of-number-of-CheckInterval-of-inactivity-before-a-client-is-logged-out"><a href="#Set-this-to-the-desired-of-number-of-CheckInterval-of-inactivity-before-a-client-is-logged-out" class="headerlink" title="Set this to the desired of number of CheckInterval of inactivity before a client is logged out"></a>Set this to the desired of number of CheckInterval of inactivity before a client is logged out</h1><h1 id="The-timeout-will-be-INTERVAL-TIMEOUT"><a href="#The-timeout-will-be-INTERVAL-TIMEOUT" class="headerlink" title="The timeout will be INTERVAL * TIMEOUT"></a>The timeout will be INTERVAL * TIMEOUT</h1><p>ClientTimeout 5</p>
<p>AuthServer是Portalserver的配置项。GatewayPort是Wifidog监听的地址。默认是2060。一般保持默认就可以；CheckInterval是心跳时长。单位是秒。什么是心跳呢，client认证成功之后，假设有网络訪问动作，Wifidog getway就会每隔一段时间訪问Portalserver的一个脚本。用于认证计费。当然。假设客户使用超时或超流量，也能够通过心跳强制client下线。ClientTimeout是用户一次认证成功后的网络訪问时长，超过这个时间须要又一次认证，这个时长并不是由ClientTimeout单独决定。取决于INTERVAL * TIMEOUT。</p>
<p>具体的配置信息能够訪问：<a target="_blank" rel="noopener" href="http://dev.wifidog.org/browser/trunk/wifidog/wifidog.conf%E3%80%82">http://dev.wifidog.org/browser/trunk/wifidog/wifidog.conf。</a></p>
<p>我们重点讨论Portalserver的配置项，Hostname是Portalserver的ip或者是域名。SSLAvailable和SSLPort是SSL加密配置，假设你的Portalserver有配置HTTPS加密，则须要配置这两项。Path是指你的脚本路径(举例。<a target="_blank" rel="noopener" href="http://a.com/to/%EF%BC%8C%E5%88%99a.com%E6%98%AF%E5%9F%9F%E5%90%8D%E3%80%82/to/%E6%98%AF%E8%B7%AF%E5%BE%84)%EF%BC%8C%E6%B3%A8%E6%84%8F%E8%B7%AF%E5%BE%84%E5%BF%85%E9%A1%BB%E4%BB%A5%E2%80%9C/%E2%80%9D%E5%BC%80%E5%A4%B4%E5%92%8C%E7%BB%93%E5%B0%BE%EF%BC%8C%E5%81%87%E8%AE%BE%E6%98%AF%E6%A0%B9%E8%B7%AF%E5%BE%84%E3%80%82%E5%88%99%E5%A1%AB%E4%B8%80%E4%B8%AA%E2%80%9C/%E2%80%9D%E5%B0%B1%E5%8F%AF%E4%BB%A5%EF%BC%9B%E6%8E%A5%E4%B8%8B%E6%9D%A5%E7%9A%845%E4%B8%AA%E9%85%8D%E7%BD%AE%E6%8C%87%E6%98%8E%E4%BD%A0%E7%9A%84%E8%84%9A%E6%9C%AC%E5%90%8D%EF%BC%8C%E8%BF%99%E8%AF%B4%E6%98%8E%E4%BA%86%E6%88%91%E4%BB%AC%E9%A1%BB%E8%A6%81%E5%86%99%E4%BA%94%E4%B8%AA%E8%84%9A%E6%9C%AC%EF%BC%8C%E6%88%91%E4%BC%9A%E5%85%B7%E4%BD%93%E8%AF%B4%E6%98%8E%E3%80%82">http://a.com/to/，则a.com是域名。/to/是路径)，注意路径必须以“/”开头和结尾，假设是根路径。则填一个“/”就可以；接下来的5个配置指明你的脚本名，这说明了我们须要写五个脚本，我会具体说明。</a></p>
<p>(下面文中涉及的“第几步”均是指Wifidog认证过程的步骤)</p>
<p>LoginScriptPathFragment配置项配置的是登陆脚本，它通过GET方式接受传入參数gw_address、gw_port、gw_id、mac和url。gw_address是AP Getway的ip地址；gw_port是Wifidog监听的端口。即上面介绍的wifidog.conf中的GatewayPort配置；gw_id是AP Getway的id。配置文件wifidog.conf中能够配置，默认值是default，这个值的作用是当存在多个AP是，server或管理员能够依据不同的id确定用户的接入点；mac是客户计算机的网卡物理地址。注意不是AP网关的mac。这个mac是用来识别客户计算机的；url是客户初始訪问的Url。这些Querystring都是AP Getway向client发出重定向请求自己主动生成的。</p>
<p>这个脚本同一时候须要提供登陆页面，假设登陆成功，须要向客户。端返回302重定向，重定向到：<a href="http://gw_address:gw_port/wifidog/auth">http://gw_address:gw_port/wifidog/auth</a>?</p>
<p>token=[token]；即实现第7步。当中[token]是你自己自己主动生成的token字符串，随机生成一个字符串就可以，可是长度最好长些，安全性更高，另外，token须要依据不同用户保存，最好保存于数据库中，之后的AP Getway询问token有效性(第9步)还须要用到。这里最好使用cookie或session，使之后的登陆成功页面能够推断用户已经成功，阻止未登录成功的人訪问认证成功页面。</p>
<p>PortalScriptPathFragment配置项配置的是登陆成功后server展示的脚本(第11步)，它通过GET方式接受1个传入參数，gw_id。这个脚本比較简单。告知用户登陆成功就可以，当然，最好重定向到用户之前想要方位的url。即第1步用户输入的URL。</p>
<p>MsgScriptPathFragment配置项配置的是错误信息展示脚本，它通过GET方式接受一个传入參数message，这个脚本也非常easy，展示message的内容就可以。目的是当认证过程出现错误，AP Getway会重定向到这个脚本，URL中含有错误的信息。</p>
<p>PingScriptPathFragment配置项配置的是心跳脚本。这个脚本它通过GET方式接受5个传入參数，gw_id，sys.uptime，sys.memfree，sys.load，wifidog.uptime，当中，sys.uptime指的是AP Getway的启动时间。sys.memfree指的是AP Getway的空暇内存，sys.load指的是AP Getway的CPU负载。wifidog.uptime指的是wifidog的启动时间，这个脚本每隔一段时间(Wifidog.conf里配置的CheckInterval)，Wifidog会自己主动訪问，可是其目的不是用户验证，而是帮助管理员管理AP节点，了解AP节点的负载情况，适时添加节点等，Wifidog訪问这个脚本时，须要这个脚本返回Pong。假设你没有统计AP节点负载数据的需求，能够丢弃这些数据。直接回应Pong，注意，这个回应仅仅包括“Pong”字符串。无需包括其它html标签。</p>
<p>AuthScriptPathFragment是用户认证脚本。实现的是第10步的功能。这个脚本它通过GET方式接受7个传入參数：stage、ip、mac、token、incoming、outcoming和gw_id。当中stage的值是login，ip是client的ip，注意不是AP Getwap的ip；mac是client的网卡物理地址。token就是你在认证脚本生成并返回给client的。incoming和outcoming用于流量控制，默认值为0；gw_id同上。</p>
<p>怎样识别用户登录成功，通过mac和token吧，LoginScriptPathFragment登陆脚本在用户登陆成功后须要记录用户的mac和token。然后在此处验证，假设匹配。回复Auth: 1，否则。回复Auth: 0。</p>
<p>另外，这个脚本也是心跳脚本。每隔一段时间Wifidog会自己主动訪问，假设用户使用时间超过限制或流量超过额度。server能够及时回应Auth: 0结束用户的訪问。</p>
<p>另外须要注意的是。回应相同无需包括html标签，另外，在Auth后的冒号和0/1之间，有一个空格，缺少这个空格也会导致出错。</p>
<p>在配置Wifidog的配置文件wifidog.conf是。配置脚本的配置项都必须以“?</p>
<p>”结尾，否则以GET方式传递的QueryString会因Url缺少问号訪问错误的脚本。</p>
<p>看到了吧。只5个简单脚本。就能够实现利用Wifidog的Portal认证，当然。这过中还能够有非常多应用尚未发掘，比方流量控制、带宽控制、结合Radiusserver实现认证等。你的开发也能够更上一层楼。实现很多其它功能。只是笔者另一个建议。在登录页面除了username和password意外，最好加个验证码，防止不怀好意之人暴力破解。</p>
<p>这样，你仅仅须要一个免费的空间，甚至是简单的百度云、新浪SAE等。就能够实现一个认证server。有的人可能还会问，能不能把这些脚本集成到路由器其中，我的回答是能，仅仅要你的脚本的功能不多。问题应该不大，可是这么做的风险比較大，路由的负载比較高，导致路由的执行会非常不稳定，甚至常常死机，这也是笔者亲身实践的结果，所以笔者不建议这么做。</p>
<p>最后啰嗦提醒的是，WiFidog是使用iptables基于三层协议工作的，所以使用Wifidog的结果是。不仅是Wifi接入须要Portal认证，有线接入相同须要认证。</p>
<p>避免这样的情况最简单的做法是设立mac白名单。可能有的人又会问。能不能做到仅是Wifi接入须要认证，有线接入的无需认证。有的人可能想更上一层楼，能不能开两个Wifi，仅当中一个Wifi须要认证，还有一个Wifi和有线网络不须要Portal认证，我的回答是能。至于详细做法，以后再介绍。</p>
<hr>
<ol>
<li><p>在这个配置文件里面第一格不能是空格，否则就会出错。</p>
</li>
<li><p>GatewayAddress  192.168.1.1 //路由器地址</p>
</li>
<li><p>GatewayID 123456789 //与服务器authpuppy中对应</p>
</li>
<li><p>ExternalInterface eth0.2  //外网接口，这个是wan口，连接到Internet的接口</p>
</li>
<li><p>GatewayInterface  br-lan  //内网接口，这个是lan口，连接到局域网的接口</p>
</li>
<li><p>AuthServer {                        //认证服务器配置项                             </p>
</li>
</ol>
<p>Hostname xx.xx.xx.xx //认证服务器IP地址或者名                                                 </p>
<p>SSLAvailable no //认证服务器有HTTPS加密则配置该项，此处无</p>
<p>SSLPort //认证服务器有HTTPS加密则配置该项，此处无</p>
<p>Path /authpuppy/web/        (认证路径)</p>
<p>/<strong><strong><strong><strong><strong><strong><strong><strong>此处为wifidog认证服务器的五个脚本文件，用于认证</strong></strong></strong></strong></strong></strong></strong></strong>****/</p>
<p>LoginScriptPathFragment //登录展示的脚本，以get的方式传入gw_address、gw_port、gw_id、mac、url(AP的IP地址，wifidog监听端口，AP的ID，客户端mac地址，客户初始访问的url)</p>
<p>PortalScriptPathFragment //客户端登陆成功后展示的脚本，之传入gw_id一个参数，用于告知用户登陆成功</p>
<p>MsgScriptPathFragment //错误信息展示脚本，通过get方式传入一个参数message，用于展示认证中出现错误的页面</p>
<p>PingScriptPathFragment //心跳脚本，通过get方式传入5个参数，gw_id，sys.uptime，sys.memfree，sys.load，wifidog.uptime；wifidog每隔一段时间访问一次这个脚本(时间间隔由CheckInterval决定)。注意，此脚本需要返回“Pong”字符串</p>
<p>AuthScriptPathFragment //用户认证脚本，通过get的方式接受7各参数，stage,ip,mac,token,incoming,outcoming和gw_id；stage的值为login,ip为客户端IP，mac为客户端的mac地址，                  }还有这个Path，一开始我是设置成  /   根目录，结果不行，出现了这个问题：HTTP Response from Server: [HTTP/1.1 404 Not Found后来设置成这个目录才可以。还有一点要注意的是Path的目录两边都要加/，不然也会出错。</p>
<ol start="7">
<li><p>GatewayPort 2060 //wifidog的监听地址，通常保持默认</p>
</li>
<li><p>CheckInterval 60 //心跳时长，单位是秒，</p>
</li>
</ol>
<p>心跳：客户端认证成功，如果有网络访问动作，Wifidog getway就会每隔一段时间访问Portal服务器的一个脚本，用于认证计费，当然，如果客户使用超时或超流量，也可以通过心跳强制客户端下线</p>
<ol start="9">
<li>ClientTimeout 5 //ClientTimeout是用户一次认证成功后的网络访问时长，超过这个时间需要重新认证</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.baidu.com/2019/11/12/20-23-33/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KK">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KK">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/12/20-23-33/" class="post-title-link" itemprop="url">selenium</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-12 20:23:33" itemprop="dateCreated datePublished" datetime="2019-11-12T20:23:33+08:00">2019-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-16 23:50:36" itemprop="dateModified" datetime="2023-05-16T23:50:36+08:00">2023-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="selenium"><a href="#selenium" class="headerlink" title="selenium"></a>selenium</h1><h2 id="在使用-selenium-对当前窗口操作，报错-no-such-window-target-window-already-closed"><a href="#在使用-selenium-对当前窗口操作，报错-no-such-window-target-window-already-closed" class="headerlink" title="在使用 selenium 对当前窗口操作，报错 no such window: target window already closed"></a>在使用 selenium 对当前窗口操作，报错 no such window: target window already closed</h2><p>关闭了新窗口后，浏览器默认显示了百度首页，但是当我们操作百度首页的时候，报了错误：没有窗口，目标窗口已关闭，因为当前窗口句柄在第二个上面，但是我们给他删掉了，在操作第二个，就会报错，将用 switch_to.window()句柄切换到第一个标签即可</p>
<h2 id="selenium-中执行使用-js-脚本"><a href="#selenium-中执行使用-js-脚本" class="headerlink" title="selenium 中执行使用 js 脚本"></a>selenium 中执行使用 js 脚本</h2><ul>
<li>使用 JS 参数传参方式<br>在使用 Javascript 语句时，还可以动态传入参数或元素对象，Js 语句中使用占位符“argument[n]”来表示取第几个参数，如</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">js = <span class="string">&quot;arguments[0].setAttribute(&#x27;style&#x27;, arguments[1]);</span></span><br><span class="line"><span class="string">element = driver.find_element_by_id(&quot;</span>kw<span class="string">&quot;)</span></span><br><span class="line"><span class="string">style = &quot;</span><span class="attr">background</span>: red; <span class="attr">border</span>: 2px solid yellow;<span class="string">&quot;</span></span><br><span class="line"><span class="string">driver.execute_script(js, element, style)</span></span><br></pre></td></tr></table></figure>

<p>这里埋设了两个参数，一个是元素对象，另一个是样式字符串。</p>
<ul>
<li>获取 js 返回值</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = driver.<span class="title function_">execute_script</span>(<span class="string">&quot;return arguments[0].value&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="selenium-运行报错：element-not-interactable"><a href="#selenium-运行报错：element-not-interactable" class="headerlink" title="selenium 运行报错：element not interactable"></a>selenium 运行报错：element not interactable</h2><ul>
<li>解决一：<br>写自动化时，没有考虑到等待时间，有时候代码运行过快，web 界面反应不过来，在这个报错的元素前添加一个等待时间，根据个人时间定等待时间<br>这个元素被隐藏了</li>
<li>解决二:<ol>
<li>打个比方，有一个退出按钮，你找到元素了，也定位了，但无法 click（），这个可能是被隐藏了，要将鼠标显示放在这个界面的位置，元素才能被找到 click（）</li>
<li>元素被隐藏了，web 界面 css 元素被隐藏</li>
</ol>
</li>
</ul>
<h2 id="Selenium-如何使用句柄方式切换窗口"><a href="#Selenium-如何使用句柄方式切换窗口" class="headerlink" title="Selenium 如何使用句柄方式切换窗口"></a>Selenium 如何使用句柄方式切换窗口</h2><p>获取当前页面句柄：<code>driver.current_window_handle</code></p>
<p>· 获取所有页面句柄：<code>driver.window_handles</code></p>
<p>通过句柄，我们可以进行窗口的切换。</p>
<p>· 切换窗口：<br><code>driver.switch_to.window(handle)</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">KK</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/a913481180" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;a913481180" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:kangkanghuang@foxmail.com" title="E-Mail → mailto:kangkanghuang@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.baidu.com/" title="http:&#x2F;&#x2F;www.baidu.com">百度</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">KK</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
